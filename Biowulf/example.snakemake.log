Building DAG of jobs...
Pulling singularity image docker://nciccbr/ccbr_clear:latest.
Pulling singularity image docker://nciccbr/ccbr_venn:latest.
Using shell: /usr/bin/bash
Provided cluster nodes: 500
Job counts:
	count	jobs
	8	alignment_stats
	1	all
	8	annotate_circRNA
	8	annotate_clear_output
	8	ciri
	8	clear
	8	create_BSJ_bam
	1	create_circexplorer_count_matrix
	1	create_ciri_count_matrix
	8	create_spliced_reads_bam
	8	cutadapt
	8	estimate_duplication
	8	fastqc
	1	merge_SJ_tabs
	1	merge_genecounts
	1	multiqc
	8	split_BAM_create_BW
	8	split_splice_reads_BAM_create_BW
	8	star1p
	8	star2p
	8	venn
	126

[Wed Mar 24 17:44:43 2021]
rule cutadapt:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-293T-NT.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz
    jobid: 8
    wildcards: sample=G_INPUT-293T-NT
    threads: 56


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT;fi
if [ "SE" == "PE" ];then
	## Paired-end
	cutadapt --pair-filter=any 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35:35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-B file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz -p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-293T-NT.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
else
	## Single-end
	cutadapt 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-293T-NT.R1.fastq.gz
	touch /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz
fi

Submitted job 8 with external jobid '11285152'.

[Wed Mar 24 17:44:48 2021]
rule cutadapt:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_293T-T.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz
    jobid: 2
    wildcards: sample=G_293T-T
    threads: 56


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T;fi
if [ "SE" == "PE" ];then
	## Paired-end
	cutadapt --pair-filter=any 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35:35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-B file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz -p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_293T-T.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
else
	## Single-end
	cutadapt 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_293T-T.R1.fastq.gz
	touch /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz
fi

Submitted job 2 with external jobid '11285219'.

[Wed Mar 24 17:44:50 2021]
rule cutadapt:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_iSLK-R.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz
    jobid: 3
    wildcards: sample=G_iSLK-R
    threads: 56


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R;fi
if [ "SE" == "PE" ];then
	## Paired-end
	cutadapt --pair-filter=any 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35:35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-B file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz -p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_iSLK-R.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
else
	## Single-end
	cutadapt 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_iSLK-R.R1.fastq.gz
	touch /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz
fi

Submitted job 3 with external jobid '11285242'.

[Wed Mar 24 17:44:53 2021]
rule cutadapt:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-iSLK-UR.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz
    jobid: 5
    wildcards: sample=G_INPUT-iSLK-UR
    threads: 56


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR;fi
if [ "SE" == "PE" ];then
	## Paired-end
	cutadapt --pair-filter=any 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35:35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-B file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz -p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-iSLK-UR.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
else
	## Single-end
	cutadapt 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-iSLK-UR.R1.fastq.gz
	touch /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz
fi

Submitted job 5 with external jobid '11285257'.

[Wed Mar 24 17:44:56 2021]
rule cutadapt:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-293T-T.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz
    jobid: 7
    wildcards: sample=G_INPUT-293T-T
    threads: 56


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T;fi
if [ "SE" == "PE" ];then
	## Paired-end
	cutadapt --pair-filter=any 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35:35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-B file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz -p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-293T-T.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
else
	## Single-end
	cutadapt 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-293T-T.R1.fastq.gz
	touch /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz
fi

Submitted job 7 with external jobid '11285258'.

[Wed Mar 24 17:44:57 2021]
rule cutadapt:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-iSLK-R.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz
    jobid: 1
    wildcards: sample=G_INPUT-iSLK-R
    threads: 56


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R;fi
if [ "SE" == "PE" ];then
	## Paired-end
	cutadapt --pair-filter=any 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35:35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-B file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz -p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-iSLK-R.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
else
	## Single-end
	cutadapt 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-iSLK-R.R1.fastq.gz
	touch /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz
fi

Submitted job 1 with external jobid '11285260'.

[Wed Mar 24 17:44:58 2021]
rule cutadapt:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_iSLK-UR.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz
    jobid: 4
    wildcards: sample=G_iSLK-UR
    threads: 56


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR;fi
if [ "SE" == "PE" ];then
	## Paired-end
	cutadapt --pair-filter=any 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35:35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-B file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz -p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_iSLK-UR.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
else
	## Single-end
	cutadapt 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_iSLK-UR.R1.fastq.gz
	touch /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz
fi

Submitted job 4 with external jobid '11285262'.

[Wed Mar 24 17:44:59 2021]
rule cutadapt:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_293t-NT.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz
    jobid: 6
    wildcards: sample=G_293t-NT
    threads: 56


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT;fi
if [ "SE" == "PE" ];then
	## Paired-end
	cutadapt --pair-filter=any 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35:35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-B file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz -p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_293t-NT.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy
else
	## Single-end
	cutadapt 	--nextseq-trim=2 	--trim-n 	-n 5 -O 5 	-q 10,10 -m 35 	-b file:/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/TruSeq_and_nextera_adapters.consolidated.fa 	-j 56 	-o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_293t-NT.R1.fastq.gz
	touch /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz
fi

Submitted job 6 with external jobid '11285264'.
[Wed Mar 24 18:13:25 2021]
Finished job 8.
1 of 126 steps (0.79%) done

[Wed Mar 24 18:13:25 2021]
rule star1p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR1p/G_INPUT-293T-NT_p1.SJ.out.tab
    jobid: 24
    wildcards: sample=G_INPUT-293T-NT
    threads: 56


if [ -d /dev/shm/G_INPUT-293T-NT ];then rm -rf /dev/shm/G_INPUT-293T-NT;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR1p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR1p;fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-293T-NT_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_INPUT-293T-NT 	--sjdbOverhang $overhang

else

#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-293T-NT_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_INPUT-293T-NT 	--sjdbOverhang $overhang

fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR1p/G_INPUT-293T-NT_p1._STARgenome
# rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR1p/G_INPUT-293T-NT_p1.Aligned.out.bam

Submitted job 24 with external jobid '11287594'.

[Wed Mar 24 18:13:26 2021]
rule ciri:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri/G_INPUT-293T-NT.ciri.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri/G_INPUT-293T-NT.bwa.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri/G_INPUT-293T-NT.bwa.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri/G_INPUT-293T-NT.ciri.out
    jobid: 74
    wildcards: sample=G_INPUT-293T-NT
    threads: 56


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri
if [ "SE" == "PE" ];then
	## paired-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz 	> G_INPUT-293T-NT.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri/G_INPUT-293T-NT.bwa.log
else
	## single-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz 	> G_INPUT-293T-NT.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri/G_INPUT-293T-NT.bwa.log
fi
perl /data/Ziegelbauer_lab/tools/CIRI_v2.0.6/CIRI2.pl -I G_INPUT-293T-NT.bwa.sam -O /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri/G_INPUT-293T-NT.ciri.out -F /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -A /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf -G /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri/G_INPUT-293T-NT.ciri.log -T 56
samtools view -@56 -bS G_INPUT-293T-NT.bwa.sam > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri/G_INPUT-293T-NT.bwa.bam
rm -rf G_INPUT-293T-NT.bwa.sam

Submitted job 74 with external jobid '11287595'.

[Wed Mar 24 18:13:28 2021]
rule fastqc:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-293T-NT.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_INPUT-293T-NT.R1.trim_fastqc.zip
    jobid: 16
    wildcards: sample=G_INPUT-293T-NT
    threads: 16


files=""
for f in /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-293T-NT.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz;do
if [ "$(wc $f|awk '{print $1}')" != "0" ];then
files=$(echo -ne "$files $f")
fi
done
fastqc $files -t 16 -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc

Submitted job 16 with external jobid '11287596'.
[Wed Mar 24 18:27:21 2021]
Finished job 5.
2 of 126 steps (2%) done

[Wed Mar 24 18:27:21 2021]
rule fastqc:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-iSLK-UR.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_INPUT-iSLK-UR.R1.trim_fastqc.zip
    jobid: 13
    wildcards: sample=G_INPUT-iSLK-UR
    threads: 16


files=""
for f in /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-iSLK-UR.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz;do
if [ "$(wc $f|awk '{print $1}')" != "0" ];then
files=$(echo -ne "$files $f")
fi
done
fastqc $files -t 16 -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc

Submitted job 13 with external jobid '11288435'.

[Wed Mar 24 18:27:22 2021]
rule ciri:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri/G_INPUT-iSLK-UR.ciri.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri/G_INPUT-iSLK-UR.bwa.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri/G_INPUT-iSLK-UR.bwa.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri/G_INPUT-iSLK-UR.ciri.out
    jobid: 71
    wildcards: sample=G_INPUT-iSLK-UR
    threads: 56


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri
if [ "SE" == "PE" ];then
	## paired-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz 	> G_INPUT-iSLK-UR.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri/G_INPUT-iSLK-UR.bwa.log
else
	## single-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz 	> G_INPUT-iSLK-UR.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri/G_INPUT-iSLK-UR.bwa.log
fi
perl /data/Ziegelbauer_lab/tools/CIRI_v2.0.6/CIRI2.pl -I G_INPUT-iSLK-UR.bwa.sam -O /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri/G_INPUT-iSLK-UR.ciri.out -F /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -A /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf -G /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri/G_INPUT-iSLK-UR.ciri.log -T 56
samtools view -@56 -bS G_INPUT-iSLK-UR.bwa.sam > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri/G_INPUT-iSLK-UR.bwa.bam
rm -rf G_INPUT-iSLK-UR.bwa.sam

Submitted job 71 with external jobid '11288436'.

[Wed Mar 24 18:27:24 2021]
rule star1p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR1p/G_INPUT-iSLK-UR_p1.SJ.out.tab
    jobid: 21
    wildcards: sample=G_INPUT-iSLK-UR
    threads: 56


if [ -d /dev/shm/G_INPUT-iSLK-UR ];then rm -rf /dev/shm/G_INPUT-iSLK-UR;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR1p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR1p;fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-iSLK-UR_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_INPUT-iSLK-UR 	--sjdbOverhang $overhang

else

#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-iSLK-UR_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_INPUT-iSLK-UR 	--sjdbOverhang $overhang

fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR1p/G_INPUT-iSLK-UR_p1._STARgenome
# rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR1p/G_INPUT-iSLK-UR_p1.Aligned.out.bam

Submitted job 21 with external jobid '11288437'.
[Wed Mar 24 18:27:43 2021]
Finished job 7.
3 of 126 steps (2%) done
[Wed Mar 24 18:27:43 2021]
Finished job 16.
4 of 126 steps (3%) done

[Wed Mar 24 18:27:43 2021]
rule fastqc:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-293T-T.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_INPUT-293T-T.R1.trim_fastqc.zip
    jobid: 15
    wildcards: sample=G_INPUT-293T-T
    threads: 16


files=""
for f in /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-293T-T.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz;do
if [ "$(wc $f|awk '{print $1}')" != "0" ];then
files=$(echo -ne "$files $f")
fi
done
fastqc $files -t 16 -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc

Submitted job 15 with external jobid '11288438'.

[Wed Mar 24 18:27:44 2021]
rule ciri:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri/G_INPUT-293T-T.ciri.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri/G_INPUT-293T-T.bwa.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri/G_INPUT-293T-T.bwa.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri/G_INPUT-293T-T.ciri.out
    jobid: 73
    wildcards: sample=G_INPUT-293T-T
    threads: 56


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri
if [ "SE" == "PE" ];then
	## paired-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz 	> G_INPUT-293T-T.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri/G_INPUT-293T-T.bwa.log
else
	## single-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz 	> G_INPUT-293T-T.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri/G_INPUT-293T-T.bwa.log
fi
perl /data/Ziegelbauer_lab/tools/CIRI_v2.0.6/CIRI2.pl -I G_INPUT-293T-T.bwa.sam -O /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri/G_INPUT-293T-T.ciri.out -F /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -A /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf -G /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri/G_INPUT-293T-T.ciri.log -T 56
samtools view -@56 -bS G_INPUT-293T-T.bwa.sam > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri/G_INPUT-293T-T.bwa.bam
rm -rf G_INPUT-293T-T.bwa.sam

Submitted job 73 with external jobid '11288439'.

[Wed Mar 24 18:27:46 2021]
rule star1p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR1p/G_INPUT-293T-T_p1.SJ.out.tab
    jobid: 23
    wildcards: sample=G_INPUT-293T-T
    threads: 56


if [ -d /dev/shm/G_INPUT-293T-T ];then rm -rf /dev/shm/G_INPUT-293T-T;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR1p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR1p;fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-293T-T_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_INPUT-293T-T 	--sjdbOverhang $overhang

else

#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-293T-T_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_INPUT-293T-T 	--sjdbOverhang $overhang

fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR1p/G_INPUT-293T-T_p1._STARgenome
# rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR1p/G_INPUT-293T-T_p1.Aligned.out.bam

Submitted job 23 with external jobid '11288440'.
[Wed Mar 24 18:28:38 2021]
Finished job 4.
5 of 126 steps (4%) done

[Wed Mar 24 18:28:38 2021]
rule fastqc:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_iSLK-UR.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_iSLK-UR.R1.trim_fastqc.zip
    jobid: 12
    wildcards: sample=G_iSLK-UR
    threads: 16


files=""
for f in /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_iSLK-UR.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz;do
if [ "$(wc $f|awk '{print $1}')" != "0" ];then
files=$(echo -ne "$files $f")
fi
done
fastqc $files -t 16 -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc

Submitted job 12 with external jobid '11288444'.

[Wed Mar 24 18:28:39 2021]
rule star1p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR1p/G_iSLK-UR_p1.SJ.out.tab
    jobid: 20
    wildcards: sample=G_iSLK-UR
    threads: 56


if [ -d /dev/shm/G_iSLK-UR ];then rm -rf /dev/shm/G_iSLK-UR;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR1p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR1p;fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_iSLK-UR_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_iSLK-UR 	--sjdbOverhang $overhang

else

#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_iSLK-UR_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_iSLK-UR 	--sjdbOverhang $overhang

fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR1p/G_iSLK-UR_p1._STARgenome
# rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR1p/G_iSLK-UR_p1.Aligned.out.bam

Submitted job 20 with external jobid '11288445'.

[Wed Mar 24 18:28:41 2021]
rule ciri:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri/G_iSLK-UR.ciri.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri/G_iSLK-UR.bwa.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri/G_iSLK-UR.bwa.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri/G_iSLK-UR.ciri.out
    jobid: 70
    wildcards: sample=G_iSLK-UR
    threads: 56


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri
if [ "SE" == "PE" ];then
	## paired-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz 	> G_iSLK-UR.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri/G_iSLK-UR.bwa.log
else
	## single-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz 	> G_iSLK-UR.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri/G_iSLK-UR.bwa.log
fi
perl /data/Ziegelbauer_lab/tools/CIRI_v2.0.6/CIRI2.pl -I G_iSLK-UR.bwa.sam -O /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri/G_iSLK-UR.ciri.out -F /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -A /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf -G /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri/G_iSLK-UR.ciri.log -T 56
samtools view -@56 -bS G_iSLK-UR.bwa.sam > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri/G_iSLK-UR.bwa.bam
rm -rf G_iSLK-UR.bwa.sam

Submitted job 70 with external jobid '11288446'.
[Wed Mar 24 18:29:33 2021]
Finished job 2.
6 of 126 steps (5%) done

[Wed Mar 24 18:29:33 2021]
rule star1p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR1p/G_293T-T_p1.SJ.out.tab
    jobid: 18
    wildcards: sample=G_293T-T
    threads: 56


if [ -d /dev/shm/G_293T-T ];then rm -rf /dev/shm/G_293T-T;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR1p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR1p;fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_293T-T_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_293T-T 	--sjdbOverhang $overhang

else

#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_293T-T_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_293T-T 	--sjdbOverhang $overhang

fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR1p/G_293T-T_p1._STARgenome
# rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR1p/G_293T-T_p1.Aligned.out.bam

Submitted job 18 with external jobid '11288669'.

[Wed Mar 24 18:29:34 2021]
rule ciri:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri/G_293T-T.ciri.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri/G_293T-T.bwa.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri/G_293T-T.bwa.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri/G_293T-T.ciri.out
    jobid: 68
    wildcards: sample=G_293T-T
    threads: 56


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri
if [ "SE" == "PE" ];then
	## paired-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz 	> G_293T-T.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri/G_293T-T.bwa.log
else
	## single-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz 	> G_293T-T.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri/G_293T-T.bwa.log
fi
perl /data/Ziegelbauer_lab/tools/CIRI_v2.0.6/CIRI2.pl -I G_293T-T.bwa.sam -O /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri/G_293T-T.ciri.out -F /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -A /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf -G /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri/G_293T-T.ciri.log -T 56
samtools view -@56 -bS G_293T-T.bwa.sam > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri/G_293T-T.bwa.bam
rm -rf G_293T-T.bwa.sam

Submitted job 68 with external jobid '11288671'.

[Wed Mar 24 18:29:36 2021]
rule fastqc:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_293T-T.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_293T-T.R1.trim_fastqc.zip
    jobid: 10
    wildcards: sample=G_293T-T
    threads: 16


files=""
for f in /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_293T-T.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz;do
if [ "$(wc $f|awk '{print $1}')" != "0" ];then
files=$(echo -ne "$files $f")
fi
done
fastqc $files -t 16 -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc

Submitted job 10 with external jobid '11288672'.
[Wed Mar 24 18:33:58 2021]
Finished job 1.
7 of 126 steps (6%) done

[Wed Mar 24 18:33:58 2021]
rule ciri:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri/G_INPUT-iSLK-R.ciri.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri/G_INPUT-iSLK-R.bwa.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri/G_INPUT-iSLK-R.bwa.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri/G_INPUT-iSLK-R.ciri.out
    jobid: 67
    wildcards: sample=G_INPUT-iSLK-R
    threads: 56


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri
if [ "SE" == "PE" ];then
	## paired-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz 	> G_INPUT-iSLK-R.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri/G_INPUT-iSLK-R.bwa.log
else
	## single-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz 	> G_INPUT-iSLK-R.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri/G_INPUT-iSLK-R.bwa.log
fi
perl /data/Ziegelbauer_lab/tools/CIRI_v2.0.6/CIRI2.pl -I G_INPUT-iSLK-R.bwa.sam -O /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri/G_INPUT-iSLK-R.ciri.out -F /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -A /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf -G /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri/G_INPUT-iSLK-R.ciri.log -T 56
samtools view -@56 -bS G_INPUT-iSLK-R.bwa.sam > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri/G_INPUT-iSLK-R.bwa.bam
rm -rf G_INPUT-iSLK-R.bwa.sam

Submitted job 67 with external jobid '11289106'.

[Wed Mar 24 18:33:59 2021]
rule fastqc:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-iSLK-R.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_INPUT-iSLK-R.R1.trim_fastqc.zip
    jobid: 9
    wildcards: sample=G_INPUT-iSLK-R
    threads: 16


files=""
for f in /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_INPUT-iSLK-R.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz;do
if [ "$(wc $f|awk '{print $1}')" != "0" ];then
files=$(echo -ne "$files $f")
fi
done
fastqc $files -t 16 -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc

Submitted job 9 with external jobid '11289107'.

[Wed Mar 24 18:34:00 2021]
rule star1p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR1p/G_INPUT-iSLK-R_p1.SJ.out.tab
    jobid: 17
    wildcards: sample=G_INPUT-iSLK-R
    threads: 56


if [ -d /dev/shm/G_INPUT-iSLK-R ];then rm -rf /dev/shm/G_INPUT-iSLK-R;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR1p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR1p;fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-iSLK-R_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_INPUT-iSLK-R 	--sjdbOverhang $overhang

else

#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-iSLK-R_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_INPUT-iSLK-R 	--sjdbOverhang $overhang

fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR1p/G_INPUT-iSLK-R_p1._STARgenome
# rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR1p/G_INPUT-iSLK-R_p1.Aligned.out.bam

Submitted job 17 with external jobid '11289108'.
[Wed Mar 24 18:36:55 2021]
Finished job 12.
8 of 126 steps (6%) done
[Wed Mar 24 18:37:49 2021]
Finished job 15.
9 of 126 steps (7%) done
[Wed Mar 24 18:38:11 2021]
Finished job 13.
10 of 126 steps (8%) done
[Wed Mar 24 18:40:34 2021]
Finished job 3.
11 of 126 steps (9%) done

[Wed Mar 24 18:40:34 2021]
rule fastqc:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_iSLK-R.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_iSLK-R.R1.trim_fastqc.zip
    jobid: 11
    wildcards: sample=G_iSLK-R
    threads: 16


files=""
for f in /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_iSLK-R.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz;do
if [ "$(wc $f|awk '{print $1}')" != "0" ];then
files=$(echo -ne "$files $f")
fi
done
fastqc $files -t 16 -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc

[Wed Mar 24 18:40:35 2021]
Finished job 10.
12 of 126 steps (10%) done
Submitted job 11 with external jobid '11290772'.

[Wed Mar 24 18:40:35 2021]
rule star1p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR1p/G_iSLK-R_p1.SJ.out.tab
    jobid: 19
    wildcards: sample=G_iSLK-R
    threads: 56


if [ -d /dev/shm/G_iSLK-R ];then rm -rf /dev/shm/G_iSLK-R;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR1p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR1p;fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_iSLK-R_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_iSLK-R 	--sjdbOverhang $overhang

else

#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_iSLK-R_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_iSLK-R 	--sjdbOverhang $overhang

fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR1p/G_iSLK-R_p1._STARgenome
# rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR1p/G_iSLK-R_p1.Aligned.out.bam

Submitted job 19 with external jobid '11290773'.

[Wed Mar 24 18:40:37 2021]
rule ciri:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri/G_iSLK-R.ciri.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri/G_iSLK-R.bwa.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri/G_iSLK-R.bwa.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri/G_iSLK-R.ciri.out
    jobid: 69
    wildcards: sample=G_iSLK-R
    threads: 56


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri
if [ "SE" == "PE" ];then
	## paired-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz 	> G_iSLK-R.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri/G_iSLK-R.bwa.log
else
	## single-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz 	> G_iSLK-R.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri/G_iSLK-R.bwa.log
fi
perl /data/Ziegelbauer_lab/tools/CIRI_v2.0.6/CIRI2.pl -I G_iSLK-R.bwa.sam -O /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri/G_iSLK-R.ciri.out -F /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -A /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf -G /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri/G_iSLK-R.ciri.log -T 56
samtools view -@56 -bS G_iSLK-R.bwa.sam > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri/G_iSLK-R.bwa.bam
rm -rf G_iSLK-R.bwa.sam

Submitted job 69 with external jobid '11290775'.
[Wed Mar 24 18:44:25 2021]
Finished job 6.
13 of 126 steps (10%) done

[Wed Mar 24 18:44:25 2021]
rule star1p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR1p/G_293t-NT_p1.SJ.out.tab
    jobid: 22
    wildcards: sample=G_293t-NT
    threads: 56


if [ -d /dev/shm/G_293t-NT ];then rm -rf /dev/shm/G_293t-NT;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR1p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR1p;fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_293t-NT_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_293t-NT 	--sjdbOverhang $overhang

else

#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR1p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 1000000 	--alignMatesGapMax 1000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix G_293t-NT_p1. 	--chimSegmentMin 20 	--chimMultimapNmax 10 	--chimOutType Junctions 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype None 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--outTmpDir=/dev/shm/G_293t-NT 	--sjdbOverhang $overhang

fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR1p/G_293t-NT_p1._STARgenome
# rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR1p/G_293t-NT_p1.Aligned.out.bam

Submitted job 22 with external jobid '11292002'.

[Wed Mar 24 18:44:27 2021]
rule ciri:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri/G_293t-NT.ciri.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri/G_293t-NT.bwa.log, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri/G_293t-NT.bwa.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri/G_293t-NT.ciri.out
    jobid: 72
    wildcards: sample=G_293t-NT
    threads: 56


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri
if [ "SE" == "PE" ];then
	## paired-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz 	> G_293t-NT.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri/G_293t-NT.bwa.log
else
	## single-end
	bwa mem -t 56 -T 19 	/data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz 	> G_293t-NT.bwa.sam 2> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri/G_293t-NT.bwa.log
fi
perl /data/Ziegelbauer_lab/tools/CIRI_v2.0.6/CIRI2.pl -I G_293t-NT.bwa.sam -O /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri/G_293t-NT.ciri.out -F /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -A /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf -G /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri/G_293t-NT.ciri.log -T 56
samtools view -@56 -bS G_293t-NT.bwa.sam > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri/G_293t-NT.bwa.bam
rm -rf G_293t-NT.bwa.sam

Submitted job 72 with external jobid '11292003'.

[Wed Mar 24 18:44:28 2021]
rule fastqc:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_293t-NT.R1.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_293t-NT.R1.trim_fastqc.zip
    jobid: 14
    wildcards: sample=G_293t-NT
    threads: 16


files=""
for f in /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/fastqs/G_293t-NT.R1.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/dummy /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz;do
if [ "$(wc $f|awk '{print $1}')" != "0" ];then
files=$(echo -ne "$files $f")
fi
done
fastqc $files -t 16 -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc

Submitted job 14 with external jobid '11292004'.
[Wed Mar 24 18:48:17 2021]
Finished job 74.
14 of 126 steps (11%) done
[Wed Mar 24 18:49:46 2021]
Finished job 9.
15 of 126 steps (12%) done
[Wed Mar 24 18:51:13 2021]
Finished job 24.
16 of 126 steps (13%) done
[Wed Mar 24 18:54:43 2021]
Finished job 11.
17 of 126 steps (13%) done
[Wed Mar 24 18:54:53 2021]
Finished job 71.
18 of 126 steps (14%) done
[Wed Mar 24 18:55:59 2021]
Finished job 73.
19 of 126 steps (15%) done
[Wed Mar 24 19:00:02 2021]
Finished job 70.
20 of 126 steps (16%) done
[Wed Mar 24 19:00:46 2021]
Finished job 20.
21 of 126 steps (17%) done
[Wed Mar 24 19:01:08 2021]
Finished job 23.
22 of 126 steps (17%) done
[Wed Mar 24 19:01:19 2021]
Finished job 21.
23 of 126 steps (18%) done
[Wed Mar 24 19:01:19 2021]
Finished job 18.
24 of 126 steps (19%) done
[Wed Mar 24 19:02:40 2021]
Finished job 17.
25 of 126 steps (20%) done
[Wed Mar 24 19:05:20 2021]
Finished job 19.
26 of 126 steps (21%) done
[Wed Mar 24 19:06:00 2021]
Finished job 67.
27 of 126 steps (21%) done
[Wed Mar 24 19:07:50 2021]
Finished job 68.
28 of 126 steps (22%) done
[Wed Mar 24 19:10:31 2021]
Finished job 14.
29 of 126 steps (23%) done
[Wed Mar 24 19:18:51 2021]
Finished job 22.
30 of 126 steps (24%) done

[Wed Mar 24 19:18:51 2021]
rule merge_SJ_tabs:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR1p/G_INPUT-iSLK-R_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR1p/G_293T-T_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR1p/G_iSLK-R_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR1p/G_iSLK-UR_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR1p/G_INPUT-iSLK-UR_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR1p/G_293t-NT_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR1p/G_INPUT-293T-T_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR1p/G_INPUT-293T-NT_p1.SJ.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    jobid: 25


cat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR1p/G_INPUT-iSLK-R_p1.SJ.out.tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR1p/G_293T-T_p1.SJ.out.tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR1p/G_iSLK-R_p1.SJ.out.tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR1p/G_iSLK-UR_p1.SJ.out.tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR1p/G_INPUT-iSLK-UR_p1.SJ.out.tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR1p/G_293t-NT_p1.SJ.out.tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR1p/G_INPUT-293T-T_p1.SJ.out.tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR1p/G_INPUT-293T-NT_p1.SJ.out.tab | python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/apply_junction_filters.py 	--regions /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions 	--filter1regions hg38,rRNA,ERCC 	--filter1_noncanonical True 	--filter1_unannotated True 	--filter2_noncanonical False 	--filter2_unannotated True | cut -f1-4 | sort -k1,1 -k2,2n | uniq > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab

Submitted job 25 with external jobid '11294722'.
[Wed Mar 24 19:19:31 2021]
Finished job 25.
31 of 126 steps (25%) done

[Wed Mar 24 19:19:31 2021]
rule star2p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.ReadsPerGene.out.tab
    jobid: 29
    wildcards: sample=G_iSLK-UR
    threads: 56


if [ -d /dev/shm/G_iSLK-UR ];then rm -rf /dev/shm/G_iSLK-UR;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p;fi
limitSjdbInsertNsj=$(wc -l /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab|awk '{print $1+1}')
if [ "$limitSjdbInsertNsj" -lt "400000" ];then limitSjdbInsertNsj="400000";fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_iSLK-UR_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_iSLK-UR 	--sjdbOverhang $overhang

else
#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_iSLK-UR_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_iSLK-UR 	--sjdbOverhang $overhang
fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2._STARgenome
## ensure the star2p file is indexed ... is should already be sorted by STAR
if [ ! -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam.bai ];then
sambamba index /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam
fi

Submitted job 29 with external jobid '11295006'.

[Wed Mar 24 19:19:33 2021]
rule star2p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.ReadsPerGene.out.tab
    jobid: 33
    wildcards: sample=G_INPUT-293T-NT
    threads: 56


if [ -d /dev/shm/G_INPUT-293T-NT ];then rm -rf /dev/shm/G_INPUT-293T-NT;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p;fi
limitSjdbInsertNsj=$(wc -l /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab|awk '{print $1+1}')
if [ "$limitSjdbInsertNsj" -lt "400000" ];then limitSjdbInsertNsj="400000";fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-293T-NT_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_INPUT-293T-NT 	--sjdbOverhang $overhang

else
#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-293T-NT_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_INPUT-293T-NT 	--sjdbOverhang $overhang
fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2._STARgenome
## ensure the star2p file is indexed ... is should already be sorted by STAR
if [ ! -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam.bai ];then
sambamba index /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam
fi

Submitted job 33 with external jobid '11295008'.

[Wed Mar 24 19:19:34 2021]
rule star2p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.ReadsPerGene.out.tab
    jobid: 26
    wildcards: sample=G_INPUT-iSLK-R
    threads: 56


if [ -d /dev/shm/G_INPUT-iSLK-R ];then rm -rf /dev/shm/G_INPUT-iSLK-R;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p;fi
limitSjdbInsertNsj=$(wc -l /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab|awk '{print $1+1}')
if [ "$limitSjdbInsertNsj" -lt "400000" ];then limitSjdbInsertNsj="400000";fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-iSLK-R_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_INPUT-iSLK-R 	--sjdbOverhang $overhang

else
#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-iSLK-R_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_INPUT-iSLK-R 	--sjdbOverhang $overhang
fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2._STARgenome
## ensure the star2p file is indexed ... is should already be sorted by STAR
if [ ! -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam.bai ];then
sambamba index /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam
fi

Submitted job 26 with external jobid '11295010'.

[Wed Mar 24 19:19:35 2021]
rule star2p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.ReadsPerGene.out.tab
    jobid: 30
    wildcards: sample=G_INPUT-iSLK-UR
    threads: 56


if [ -d /dev/shm/G_INPUT-iSLK-UR ];then rm -rf /dev/shm/G_INPUT-iSLK-UR;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p;fi
limitSjdbInsertNsj=$(wc -l /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab|awk '{print $1+1}')
if [ "$limitSjdbInsertNsj" -lt "400000" ];then limitSjdbInsertNsj="400000";fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-iSLK-UR_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_INPUT-iSLK-UR 	--sjdbOverhang $overhang

else
#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-iSLK-UR_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_INPUT-iSLK-UR 	--sjdbOverhang $overhang
fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2._STARgenome
## ensure the star2p file is indexed ... is should already be sorted by STAR
if [ ! -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam.bai ];then
sambamba index /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam
fi

Submitted job 30 with external jobid '11295012'.

[Wed Mar 24 19:19:36 2021]
rule star2p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.ReadsPerGene.out.tab
    jobid: 27
    wildcards: sample=G_293T-T
    threads: 56


if [ -d /dev/shm/G_293T-T ];then rm -rf /dev/shm/G_293T-T;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p;fi
limitSjdbInsertNsj=$(wc -l /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab|awk '{print $1+1}')
if [ "$limitSjdbInsertNsj" -lt "400000" ];then limitSjdbInsertNsj="400000";fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_293T-T_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_293T-T 	--sjdbOverhang $overhang

else
#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_293T-T_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_293T-T 	--sjdbOverhang $overhang
fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2._STARgenome
## ensure the star2p file is indexed ... is should already be sorted by STAR
if [ ! -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam.bai ];then
sambamba index /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam
fi

Submitted job 27 with external jobid '11295014'.

[Wed Mar 24 19:19:38 2021]
rule star2p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.ReadsPerGene.out.tab
    jobid: 31
    wildcards: sample=G_293t-NT
    threads: 56


if [ -d /dev/shm/G_293t-NT ];then rm -rf /dev/shm/G_293t-NT;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p;fi
limitSjdbInsertNsj=$(wc -l /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab|awk '{print $1+1}')
if [ "$limitSjdbInsertNsj" -lt "400000" ];then limitSjdbInsertNsj="400000";fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_293t-NT_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_293t-NT 	--sjdbOverhang $overhang

else
#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_293t-NT_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_293t-NT 	--sjdbOverhang $overhang
fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2._STARgenome
## ensure the star2p file is indexed ... is should already be sorted by STAR
if [ ! -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam.bai ];then
sambamba index /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam
fi

Submitted job 31 with external jobid '11295015'.

[Wed Mar 24 19:19:39 2021]
rule star2p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.ReadsPerGene.out.tab
    jobid: 28
    wildcards: sample=G_iSLK-R
    threads: 56


if [ -d /dev/shm/G_iSLK-R ];then rm -rf /dev/shm/G_iSLK-R;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p;fi
limitSjdbInsertNsj=$(wc -l /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab|awk '{print $1+1}')
if [ "$limitSjdbInsertNsj" -lt "400000" ];then limitSjdbInsertNsj="400000";fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_iSLK-R_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_iSLK-R 	--sjdbOverhang $overhang

else
#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_iSLK-R_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_iSLK-R 	--sjdbOverhang $overhang
fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2._STARgenome
## ensure the star2p file is indexed ... is should already be sorted by STAR
if [ ! -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam.bai ];then
sambamba index /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam
fi

Submitted job 28 with external jobid '11295016'.

[Wed Mar 24 19:19:40 2021]
rule star2p:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.ReadsPerGene.out.tab
    jobid: 32
    wildcards: sample=G_INPUT-293T-T
    threads: 56


if [ -d /dev/shm/G_INPUT-293T-T ];then rm -rf /dev/shm/G_INPUT-293T-T;fi
if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p;fi
limitSjdbInsertNsj=$(wc -l /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab|awk '{print $1+1}')
if [ "$limitSjdbInsertNsj" -lt "400000" ];then limitSjdbInsertNsj="400000";fi
if [ "SE" == "PE" ];then
# paired-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-293T-T_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_INPUT-293T-T 	--sjdbOverhang $overhang

else
#single-end
	overhang=$(zcat /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz | awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; END {print maxlen-1}')
	echo "sjdbOverhang for STAR: ${overhang}"
	cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p
	STAR --genomeDir /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/STAR_index_no_GTF_2.7.6a 	--outSAMstrandField None  	--outFilterType BySJout 	--outFilterMultimapNmax 20 	--alignSJoverhangMin 8 	--alignSJDBoverhangMin 1 	--outFilterMismatchNmax 999 	--outFilterMismatchNoverLmax 0.3  	--alignIntronMin 20 	--alignIntronMax 2000000 	--alignMatesGapMax 2000000 	--readFilesIn /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz 	--readFilesCommand  zcat 	--runThreadN 56 	--outFileNamePrefix G_INPUT-293T-T_p2. 	--sjdbFileChrStartEnd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab 	--chimSegmentMin 20 	--chimOutType Junctions WithinBAM 	--chimMultimapNmax 10 	--limitSjdbInsertNsj $limitSjdbInsertNsj 	--alignTranscriptsPerReadNmax 20000 	--outSAMtype BAM SortedByCoordinate 	--alignEndsProtrude 10 ConcordantPair 	--outFilterIntronMotifs None 	--sjdbGTFfile /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.gtf 	--quantMode GeneCounts 	--outTmpDir=/dev/shm/G_INPUT-293T-T 	--sjdbOverhang $overhang
fi
rm -rf /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2._STARgenome
## ensure the star2p file is indexed ... is should already be sorted by STAR
if [ ! -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam.bai ];then
sambamba index /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam
fi

Submitted job 32 with external jobid '11295017'.
[Wed Mar 24 19:21:08 2021]
Finished job 69.
32 of 126 steps (25%) done
[Wed Mar 24 19:28:20 2021]
Finished job 72.
33 of 126 steps (26%) done

[Wed Mar 24 19:28:20 2021]
rule create_ciri_count_matrix:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri/G_INPUT-iSLK-R.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri/G_293T-T.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri/G_iSLK-R.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri/G_iSLK-UR.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri/G_INPUT-iSLK-UR.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri/G_293t-NT.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri/G_INPUT-293T-T.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri/G_INPUT-293T-NT.ciri.out
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/ciri_count_matrix.txt
    jobid: 75


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/Create_ciri_count_matrix.py /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/hg38_2_hg19_lookup.txt

Submitted job 75 with external jobid '11296218'.
[Wed Mar 24 19:29:00 2021]
Finished job 75.
34 of 126 steps (27%) done
[Wed Mar 24 19:33:10 2021]
Finished job 29.
35 of 126 steps (28%) done

[Wed Mar 24 19:33:10 2021]
rule create_spliced_reads_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.spliced_reads.bam
    jobid: 121
    wildcards: sample=G_iSLK-UR
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_splice_reads.py --inbam /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam --outbam /dev/shm/G_iSLK-UR.SR.bam --tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.spliced_reads.bam /dev/shm/G_iSLK-UR.SR.bam
rm -f /dev/shm/G_iSLK-UR.SR.bam*

Submitted job 121 with external jobid '11296731'.

[Wed Mar 24 19:33:12 2021]
rule create_BSJ_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.readids, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.bam
    jobid: 46
    wildcards: sample=G_iSLK-UR
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p

## get BSJ readids along with chrom,site,cigar etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/junctions2readids.py -j /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Chimeric.out.junction > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.readids

## extract only the uniq readids
cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.readids | sort | uniq > /dev/shm/G_iSLK-UR.readids

## downsize the star2p bam file to a new bam file with only BSJ reads ... these may still contain alignments which are chimeric but not BSJ
## note the argument --readids here is just a list of readids
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_by_readids.py --inputBAM /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam --outputBAM /dev/shm/G_iSLK-UR.chimeric.bam --readids /dev/shm/G_iSLK-UR.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_iSLK-UR.chimeric.sorted.bam /dev/shm/G_iSLK-UR.chimeric.bam
rm -f /dev/shm/G_iSLK-UR.chimeric.bam*

## using the downsized star2p bam file containing chimeric alignments ...included all the BSJs... we now extract only the BSJs
## note the argument --readids here is a tab delimited file created by junctions2readids.py ... reaids,chrom,strand,sites,cigars,etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_BSJs.py --inputBAM /dev/shm/G_iSLK-UR.chimeric.sorted.bam --outputBAM /dev/shm/G_iSLK-UR.BSJs.tmp.bam --readids /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_iSLK-UR.BSJs.tmp.sorted.bam /dev/shm/G_iSLK-UR.BSJs.tmp.bam
rm -f /dev/shm/G_iSLK-UR.BSJs.tmp.bam*

## some alignments are repeated/duplicated in the output for some reason ... hence deduplicating
samtools view -H /dev/shm/G_iSLK-UR.BSJs.tmp.sorted.bam > /dev/shm/G_iSLK-UR.BSJs.tmp.dedup.sam
samtools view /dev/shm/G_iSLK-UR.BSJs.tmp.sorted.bam | sort | uniq >> /dev/shm/G_iSLK-UR.BSJs.tmp.dedup.sam
samtools view -bS /dev/shm/G_iSLK-UR.BSJs.tmp.dedup.sam > /dev/shm/G_iSLK-UR.BSJs.tmp.dedup.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.bam /dev/shm/G_iSLK-UR.BSJs.tmp.dedup.bam
rm -f /dev/shm/G_iSLK-UR.BSJs.tmp.dedup.bam*

Submitted job 46 with external jobid '11296732'.

[Wed Mar 24 19:33:13 2021]
rule annotate_circRNA:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Chimeric.out.junction
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer/G_iSLK-UR.back_spliced_junction.bed, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer/G_iSLK-UR.circularRNA_known.txt
    jobid: 62
    wildcards: sample=G_iSLK-UR


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer;fi
cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Chimeric.out.junction /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Chimeric.out.junction.original
grep -v junction_type /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Chimeric.out.junction.original > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Chimeric.out.junction
CIRCexplorer2 parse 	-t STAR 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Chimeric.out.junction > G_iSLK-UR_circexplorer_parse.log 2>&1
mv back_spliced_junction.bed /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer/G_iSLK-UR.back_spliced_junction.bed
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Chimeric.out.junction.original /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Chimeric.out.junction
CIRCexplorer2 annotate -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -g /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer/G_iSLK-UR.back_spliced_junction.bed -o $(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer/G_iSLK-UR.circularRNA_known.txt) --low-confidence

Submitted job 62 with external jobid '11296733'.

[Wed Mar 24 19:33:14 2021]
rule estimate_duplication:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_iSLK-UR.MarkDuplicates.metrics.txt
    jobid: 38
    wildcards: sample=G_iSLK-UR


java -Xmx100G -jar ${PICARD_JARPATH}/picard.jar MarkDuplicates I=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam O=/dev/shm/G_iSLK-UR.mark_dup.bam M=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_iSLK-UR.MarkDuplicates.metrics.txt

Submitted job 38 with external jobid '11296734'.
[Wed Mar 24 19:33:53 2021]
Finished job 30.
36 of 126 steps (29%) done
[Wed Mar 24 19:33:53 2021]
Finished job 32.
37 of 126 steps (29%) done

[Wed Mar 24 19:33:53 2021]
rule estimate_duplication:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-iSLK-UR.MarkDuplicates.metrics.txt
    jobid: 39
    wildcards: sample=G_INPUT-iSLK-UR


java -Xmx100G -jar ${PICARD_JARPATH}/picard.jar MarkDuplicates I=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam O=/dev/shm/G_INPUT-iSLK-UR.mark_dup.bam M=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-iSLK-UR.MarkDuplicates.metrics.txt

Submitted job 39 with external jobid '11296736'.

[Wed Mar 24 19:33:55 2021]
rule create_BSJ_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.readids, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.bam
    jobid: 47
    wildcards: sample=G_INPUT-iSLK-UR
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p

## get BSJ readids along with chrom,site,cigar etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/junctions2readids.py -j /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Chimeric.out.junction > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.readids

## extract only the uniq readids
cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.readids | sort | uniq > /dev/shm/G_INPUT-iSLK-UR.readids

## downsize the star2p bam file to a new bam file with only BSJ reads ... these may still contain alignments which are chimeric but not BSJ
## note the argument --readids here is just a list of readids
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_by_readids.py --inputBAM /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam --outputBAM /dev/shm/G_INPUT-iSLK-UR.chimeric.bam --readids /dev/shm/G_INPUT-iSLK-UR.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_INPUT-iSLK-UR.chimeric.sorted.bam /dev/shm/G_INPUT-iSLK-UR.chimeric.bam
rm -f /dev/shm/G_INPUT-iSLK-UR.chimeric.bam*

## using the downsized star2p bam file containing chimeric alignments ...included all the BSJs... we now extract only the BSJs
## note the argument --readids here is a tab delimited file created by junctions2readids.py ... reaids,chrom,strand,sites,cigars,etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_BSJs.py --inputBAM /dev/shm/G_INPUT-iSLK-UR.chimeric.sorted.bam --outputBAM /dev/shm/G_INPUT-iSLK-UR.BSJs.tmp.bam --readids /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_INPUT-iSLK-UR.BSJs.tmp.sorted.bam /dev/shm/G_INPUT-iSLK-UR.BSJs.tmp.bam
rm -f /dev/shm/G_INPUT-iSLK-UR.BSJs.tmp.bam*

## some alignments are repeated/duplicated in the output for some reason ... hence deduplicating
samtools view -H /dev/shm/G_INPUT-iSLK-UR.BSJs.tmp.sorted.bam > /dev/shm/G_INPUT-iSLK-UR.BSJs.tmp.dedup.sam
samtools view /dev/shm/G_INPUT-iSLK-UR.BSJs.tmp.sorted.bam | sort | uniq >> /dev/shm/G_INPUT-iSLK-UR.BSJs.tmp.dedup.sam
samtools view -bS /dev/shm/G_INPUT-iSLK-UR.BSJs.tmp.dedup.sam > /dev/shm/G_INPUT-iSLK-UR.BSJs.tmp.dedup.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.bam /dev/shm/G_INPUT-iSLK-UR.BSJs.tmp.dedup.bam
rm -f /dev/shm/G_INPUT-iSLK-UR.BSJs.tmp.dedup.bam*

Submitted job 47 with external jobid '11296737'.

[Wed Mar 24 19:33:56 2021]
rule create_spliced_reads_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.spliced_reads.bam
    jobid: 122
    wildcards: sample=G_INPUT-iSLK-UR
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_splice_reads.py --inbam /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam --outbam /dev/shm/G_INPUT-iSLK-UR.SR.bam --tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.spliced_reads.bam /dev/shm/G_INPUT-iSLK-UR.SR.bam
rm -f /dev/shm/G_INPUT-iSLK-UR.SR.bam*

Submitted job 122 with external jobid '11296738'.

[Wed Mar 24 19:33:57 2021]
rule annotate_circRNA:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Chimeric.out.junction
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer/G_INPUT-iSLK-UR.back_spliced_junction.bed, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer/G_INPUT-iSLK-UR.circularRNA_known.txt
    jobid: 63
    wildcards: sample=G_INPUT-iSLK-UR


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer;fi
cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Chimeric.out.junction /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Chimeric.out.junction.original
grep -v junction_type /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Chimeric.out.junction.original > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Chimeric.out.junction
CIRCexplorer2 parse 	-t STAR 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Chimeric.out.junction > G_INPUT-iSLK-UR_circexplorer_parse.log 2>&1
mv back_spliced_junction.bed /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer/G_INPUT-iSLK-UR.back_spliced_junction.bed
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Chimeric.out.junction.original /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Chimeric.out.junction
CIRCexplorer2 annotate -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -g /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer/G_INPUT-iSLK-UR.back_spliced_junction.bed -o $(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer/G_INPUT-iSLK-UR.circularRNA_known.txt) --low-confidence

Submitted job 63 with external jobid '11296739'.

[Wed Mar 24 19:33:59 2021]
rule annotate_circRNA:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Chimeric.out.junction
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer/G_INPUT-293T-T.back_spliced_junction.bed, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer/G_INPUT-293T-T.circularRNA_known.txt
    jobid: 65
    wildcards: sample=G_INPUT-293T-T


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer;fi
cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Chimeric.out.junction /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Chimeric.out.junction.original
grep -v junction_type /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Chimeric.out.junction.original > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Chimeric.out.junction
CIRCexplorer2 parse 	-t STAR 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Chimeric.out.junction > G_INPUT-293T-T_circexplorer_parse.log 2>&1
mv back_spliced_junction.bed /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer/G_INPUT-293T-T.back_spliced_junction.bed
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Chimeric.out.junction.original /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Chimeric.out.junction
CIRCexplorer2 annotate -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -g /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer/G_INPUT-293T-T.back_spliced_junction.bed -o $(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer/G_INPUT-293T-T.circularRNA_known.txt) --low-confidence

Submitted job 65 with external jobid '11296740'.

[Wed Mar 24 19:34:00 2021]
rule create_spliced_reads_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.spliced_reads.bam
    jobid: 124
    wildcards: sample=G_INPUT-293T-T
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_splice_reads.py --inbam /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam --outbam /dev/shm/G_INPUT-293T-T.SR.bam --tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.spliced_reads.bam /dev/shm/G_INPUT-293T-T.SR.bam
rm -f /dev/shm/G_INPUT-293T-T.SR.bam*

Submitted job 124 with external jobid '11296741'.

[Wed Mar 24 19:34:02 2021]
rule estimate_duplication:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-293T-T.MarkDuplicates.metrics.txt
    jobid: 41
    wildcards: sample=G_INPUT-293T-T


java -Xmx100G -jar ${PICARD_JARPATH}/picard.jar MarkDuplicates I=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam O=/dev/shm/G_INPUT-293T-T.mark_dup.bam M=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-293T-T.MarkDuplicates.metrics.txt

Submitted job 41 with external jobid '11296742'.

[Wed Mar 24 19:34:03 2021]
rule create_BSJ_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.readids, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.bam
    jobid: 49
    wildcards: sample=G_INPUT-293T-T
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p

## get BSJ readids along with chrom,site,cigar etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/junctions2readids.py -j /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Chimeric.out.junction > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.readids

## extract only the uniq readids
cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.readids | sort | uniq > /dev/shm/G_INPUT-293T-T.readids

## downsize the star2p bam file to a new bam file with only BSJ reads ... these may still contain alignments which are chimeric but not BSJ
## note the argument --readids here is just a list of readids
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_by_readids.py --inputBAM /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam --outputBAM /dev/shm/G_INPUT-293T-T.chimeric.bam --readids /dev/shm/G_INPUT-293T-T.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_INPUT-293T-T.chimeric.sorted.bam /dev/shm/G_INPUT-293T-T.chimeric.bam
rm -f /dev/shm/G_INPUT-293T-T.chimeric.bam*

## using the downsized star2p bam file containing chimeric alignments ...included all the BSJs... we now extract only the BSJs
## note the argument --readids here is a tab delimited file created by junctions2readids.py ... reaids,chrom,strand,sites,cigars,etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_BSJs.py --inputBAM /dev/shm/G_INPUT-293T-T.chimeric.sorted.bam --outputBAM /dev/shm/G_INPUT-293T-T.BSJs.tmp.bam --readids /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_INPUT-293T-T.BSJs.tmp.sorted.bam /dev/shm/G_INPUT-293T-T.BSJs.tmp.bam
rm -f /dev/shm/G_INPUT-293T-T.BSJs.tmp.bam*

## some alignments are repeated/duplicated in the output for some reason ... hence deduplicating
samtools view -H /dev/shm/G_INPUT-293T-T.BSJs.tmp.sorted.bam > /dev/shm/G_INPUT-293T-T.BSJs.tmp.dedup.sam
samtools view /dev/shm/G_INPUT-293T-T.BSJs.tmp.sorted.bam | sort | uniq >> /dev/shm/G_INPUT-293T-T.BSJs.tmp.dedup.sam
samtools view -bS /dev/shm/G_INPUT-293T-T.BSJs.tmp.dedup.sam > /dev/shm/G_INPUT-293T-T.BSJs.tmp.dedup.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.bam /dev/shm/G_INPUT-293T-T.BSJs.tmp.dedup.bam
rm -f /dev/shm/G_INPUT-293T-T.BSJs.tmp.dedup.bam*

Submitted job 49 with external jobid '11296743'.
[Wed Mar 24 19:34:48 2021]
Finished job 27.
38 of 126 steps (30%) done

[Wed Mar 24 19:34:48 2021]
rule estimate_duplication:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_293T-T.MarkDuplicates.metrics.txt
    jobid: 36
    wildcards: sample=G_293T-T


java -Xmx100G -jar ${PICARD_JARPATH}/picard.jar MarkDuplicates I=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam O=/dev/shm/G_293T-T.mark_dup.bam M=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_293T-T.MarkDuplicates.metrics.txt

Submitted job 36 with external jobid '11296744'.

[Wed Mar 24 19:34:50 2021]
rule create_BSJ_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.readids, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.bam
    jobid: 44
    wildcards: sample=G_293T-T
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p

## get BSJ readids along with chrom,site,cigar etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/junctions2readids.py -j /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Chimeric.out.junction > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.readids

## extract only the uniq readids
cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.readids | sort | uniq > /dev/shm/G_293T-T.readids

## downsize the star2p bam file to a new bam file with only BSJ reads ... these may still contain alignments which are chimeric but not BSJ
## note the argument --readids here is just a list of readids
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_by_readids.py --inputBAM /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam --outputBAM /dev/shm/G_293T-T.chimeric.bam --readids /dev/shm/G_293T-T.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_293T-T.chimeric.sorted.bam /dev/shm/G_293T-T.chimeric.bam
rm -f /dev/shm/G_293T-T.chimeric.bam*

## using the downsized star2p bam file containing chimeric alignments ...included all the BSJs... we now extract only the BSJs
## note the argument --readids here is a tab delimited file created by junctions2readids.py ... reaids,chrom,strand,sites,cigars,etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_BSJs.py --inputBAM /dev/shm/G_293T-T.chimeric.sorted.bam --outputBAM /dev/shm/G_293T-T.BSJs.tmp.bam --readids /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_293T-T.BSJs.tmp.sorted.bam /dev/shm/G_293T-T.BSJs.tmp.bam
rm -f /dev/shm/G_293T-T.BSJs.tmp.bam*

## some alignments are repeated/duplicated in the output for some reason ... hence deduplicating
samtools view -H /dev/shm/G_293T-T.BSJs.tmp.sorted.bam > /dev/shm/G_293T-T.BSJs.tmp.dedup.sam
samtools view /dev/shm/G_293T-T.BSJs.tmp.sorted.bam | sort | uniq >> /dev/shm/G_293T-T.BSJs.tmp.dedup.sam
samtools view -bS /dev/shm/G_293T-T.BSJs.tmp.dedup.sam > /dev/shm/G_293T-T.BSJs.tmp.dedup.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.bam /dev/shm/G_293T-T.BSJs.tmp.dedup.bam
rm -f /dev/shm/G_293T-T.BSJs.tmp.dedup.bam*

Submitted job 44 with external jobid '11296745'.

[Wed Mar 24 19:34:51 2021]
rule create_spliced_reads_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.spliced_reads.bam
    jobid: 119
    wildcards: sample=G_293T-T
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_splice_reads.py --inbam /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam --outbam /dev/shm/G_293T-T.SR.bam --tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.spliced_reads.bam /dev/shm/G_293T-T.SR.bam
rm -f /dev/shm/G_293T-T.SR.bam*

Submitted job 119 with external jobid '11296746'.

[Wed Mar 24 19:34:52 2021]
rule annotate_circRNA:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Chimeric.out.junction
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer/G_293T-T.back_spliced_junction.bed, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer/G_293T-T.circularRNA_known.txt
    jobid: 60
    wildcards: sample=G_293T-T


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer;fi
cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Chimeric.out.junction /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Chimeric.out.junction.original
grep -v junction_type /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Chimeric.out.junction.original > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Chimeric.out.junction
CIRCexplorer2 parse 	-t STAR 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Chimeric.out.junction > G_293T-T_circexplorer_parse.log 2>&1
mv back_spliced_junction.bed /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer/G_293T-T.back_spliced_junction.bed
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Chimeric.out.junction.original /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Chimeric.out.junction
CIRCexplorer2 annotate -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -g /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer/G_293T-T.back_spliced_junction.bed -o $(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer/G_293T-T.circularRNA_known.txt) --low-confidence

Submitted job 60 with external jobid '11296747'.
[Wed Mar 24 19:35:24 2021]
Finished job 63.
39 of 126 steps (31%) done
[Wed Mar 24 19:35:24 2021]
Finished job 65.
40 of 126 steps (32%) done

[Wed Mar 24 19:35:24 2021]
rule venn:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer/G_INPUT-iSLK-UR.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri/G_INPUT-iSLK-UR.ciri.out
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/G_INPUT-iSLK-UR.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/G_INPUT-iSLK-UR.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/G_INPUT-iSLK-UR.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/G_INPUT-iSLK-UR.common.lst
    jobid: 113
    wildcards: sample=G_INPUT-iSLK-UR
    threads: 2


cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri/G_INPUT-iSLK-UR.ciri.out|grep -v circRNA_ID > /dev/shm/G_INPUT-iSLK-UR.ciri.lst
cut -f1-3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer/G_INPUT-iSLK-UR.circularRNA_known.txt|awk -F"\t" '{print $1":"$2+1"|"$3}' > /dev/shm/G_INPUT-iSLK-UR.circExplorer.lst
2set_venn.R 	-l /dev/shm/G_INPUT-iSLK-UR.ciri.lst 	-r /dev/shm/G_INPUT-iSLK-UR.circExplorer.lst  	-p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/G_INPUT-iSLK-UR.venn_mqc.png 	-m /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/G_INPUT-iSLK-UR.cirionly.lst 	-s /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/G_INPUT-iSLK-UR.circexploreronly.lst 	-c1 "CIRI2" 	-c2 "CircExplorer2" 	-c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/G_INPUT-iSLK-UR.common.lst 	-t G_INPUT-iSLK-UR

[Wed Mar 24 19:35:24 2021]
Finished job 60.
41 of 126 steps (33%) done
Submitted job 113 with external jobid '11296962'.

[Wed Mar 24 19:35:26 2021]
rule clear:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer/G_INPUT-iSLK-UR.circularRNA_known.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/CLEAR/quant.txt
    jobid: 101
    wildcards: sample=G_INPUT-iSLK-UR
    threads: 4


circ_quant -c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer/G_INPUT-iSLK-UR.circularRNA_known.txt -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam -t -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/CLEAR/quant.txt

Submitted job 101 with external jobid '11296963'.

[Wed Mar 24 19:35:28 2021]
rule clear:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer/G_293T-T.circularRNA_known.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/CLEAR/quant.txt
    jobid: 95
    wildcards: sample=G_293T-T
    threads: 4


circ_quant -c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer/G_293T-T.circularRNA_known.txt -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam -t -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/CLEAR/quant.txt

Submitted job 95 with external jobid '11296965'.

[Wed Mar 24 19:35:29 2021]
rule venn:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer/G_293T-T.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri/G_293T-T.ciri.out
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/G_293T-T.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/G_293T-T.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/G_293T-T.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/G_293T-T.common.lst
    jobid: 110
    wildcards: sample=G_293T-T
    threads: 2


cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri/G_293T-T.ciri.out|grep -v circRNA_ID > /dev/shm/G_293T-T.ciri.lst
cut -f1-3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer/G_293T-T.circularRNA_known.txt|awk -F"\t" '{print $1":"$2+1"|"$3}' > /dev/shm/G_293T-T.circExplorer.lst
2set_venn.R 	-l /dev/shm/G_293T-T.ciri.lst 	-r /dev/shm/G_293T-T.circExplorer.lst  	-p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/G_293T-T.venn_mqc.png 	-m /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/G_293T-T.cirionly.lst 	-s /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/G_293T-T.circexploreronly.lst 	-c1 "CIRI2" 	-c2 "CircExplorer2" 	-c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/G_293T-T.common.lst 	-t G_293T-T

Submitted job 110 with external jobid '11296967'.

[Wed Mar 24 19:35:30 2021]
rule venn:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer/G_INPUT-293T-T.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri/G_INPUT-293T-T.ciri.out
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/G_INPUT-293T-T.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/G_INPUT-293T-T.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/G_INPUT-293T-T.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/G_INPUT-293T-T.common.lst
    jobid: 115
    wildcards: sample=G_INPUT-293T-T
    threads: 2


cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri/G_INPUT-293T-T.ciri.out|grep -v circRNA_ID > /dev/shm/G_INPUT-293T-T.ciri.lst
cut -f1-3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer/G_INPUT-293T-T.circularRNA_known.txt|awk -F"\t" '{print $1":"$2+1"|"$3}' > /dev/shm/G_INPUT-293T-T.circExplorer.lst
2set_venn.R 	-l /dev/shm/G_INPUT-293T-T.ciri.lst 	-r /dev/shm/G_INPUT-293T-T.circExplorer.lst  	-p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/G_INPUT-293T-T.venn_mqc.png 	-m /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/G_INPUT-293T-T.cirionly.lst 	-s /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/G_INPUT-293T-T.circexploreronly.lst 	-c1 "CIRI2" 	-c2 "CircExplorer2" 	-c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/G_INPUT-293T-T.common.lst 	-t G_INPUT-293T-T

Submitted job 115 with external jobid '11296969'.

[Wed Mar 24 19:35:32 2021]
rule clear:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer/G_INPUT-293T-T.circularRNA_known.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/CLEAR/quant.txt
    jobid: 105
    wildcards: sample=G_INPUT-293T-T
    threads: 4


circ_quant -c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer/G_INPUT-293T-T.circularRNA_known.txt -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam -t -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/CLEAR/quant.txt

Submitted job 105 with external jobid '11296971'.
[Wed Mar 24 19:35:35 2021]
Finished job 62.
42 of 126 steps (33%) done

[Wed Mar 24 19:35:35 2021]
rule clear:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer/G_iSLK-UR.circularRNA_known.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/CLEAR/quant.txt
    jobid: 99
    wildcards: sample=G_iSLK-UR
    threads: 4


circ_quant -c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer/G_iSLK-UR.circularRNA_known.txt -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam -t -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/CLEAR/quant.txt

Submitted job 99 with external jobid '11296972'.

[Wed Mar 24 19:35:37 2021]
rule venn:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer/G_iSLK-UR.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri/G_iSLK-UR.ciri.out
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/G_iSLK-UR.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/G_iSLK-UR.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/G_iSLK-UR.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/G_iSLK-UR.common.lst
    jobid: 112
    wildcards: sample=G_iSLK-UR
    threads: 2


cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri/G_iSLK-UR.ciri.out|grep -v circRNA_ID > /dev/shm/G_iSLK-UR.ciri.lst
cut -f1-3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer/G_iSLK-UR.circularRNA_known.txt|awk -F"\t" '{print $1":"$2+1"|"$3}' > /dev/shm/G_iSLK-UR.circExplorer.lst
2set_venn.R 	-l /dev/shm/G_iSLK-UR.ciri.lst 	-r /dev/shm/G_iSLK-UR.circExplorer.lst  	-p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/G_iSLK-UR.venn_mqc.png 	-m /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/G_iSLK-UR.cirionly.lst 	-s /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/G_iSLK-UR.circexploreronly.lst 	-c1 "CIRI2" 	-c2 "CircExplorer2" 	-c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/G_iSLK-UR.common.lst 	-t G_iSLK-UR

Submitted job 112 with external jobid '11296973'.
[Wed Mar 24 19:35:47 2021]
Finished job 26.
43 of 126 steps (34%) done

[Wed Mar 24 19:35:47 2021]
rule create_BSJ_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.readids, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.bam
    jobid: 43
    wildcards: sample=G_INPUT-iSLK-R
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p

## get BSJ readids along with chrom,site,cigar etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/junctions2readids.py -j /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Chimeric.out.junction > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.readids

## extract only the uniq readids
cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.readids | sort | uniq > /dev/shm/G_INPUT-iSLK-R.readids

## downsize the star2p bam file to a new bam file with only BSJ reads ... these may still contain alignments which are chimeric but not BSJ
## note the argument --readids here is just a list of readids
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_by_readids.py --inputBAM /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam --outputBAM /dev/shm/G_INPUT-iSLK-R.chimeric.bam --readids /dev/shm/G_INPUT-iSLK-R.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_INPUT-iSLK-R.chimeric.sorted.bam /dev/shm/G_INPUT-iSLK-R.chimeric.bam
rm -f /dev/shm/G_INPUT-iSLK-R.chimeric.bam*

## using the downsized star2p bam file containing chimeric alignments ...included all the BSJs... we now extract only the BSJs
## note the argument --readids here is a tab delimited file created by junctions2readids.py ... reaids,chrom,strand,sites,cigars,etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_BSJs.py --inputBAM /dev/shm/G_INPUT-iSLK-R.chimeric.sorted.bam --outputBAM /dev/shm/G_INPUT-iSLK-R.BSJs.tmp.bam --readids /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_INPUT-iSLK-R.BSJs.tmp.sorted.bam /dev/shm/G_INPUT-iSLK-R.BSJs.tmp.bam
rm -f /dev/shm/G_INPUT-iSLK-R.BSJs.tmp.bam*

## some alignments are repeated/duplicated in the output for some reason ... hence deduplicating
samtools view -H /dev/shm/G_INPUT-iSLK-R.BSJs.tmp.sorted.bam > /dev/shm/G_INPUT-iSLK-R.BSJs.tmp.dedup.sam
samtools view /dev/shm/G_INPUT-iSLK-R.BSJs.tmp.sorted.bam | sort | uniq >> /dev/shm/G_INPUT-iSLK-R.BSJs.tmp.dedup.sam
samtools view -bS /dev/shm/G_INPUT-iSLK-R.BSJs.tmp.dedup.sam > /dev/shm/G_INPUT-iSLK-R.BSJs.tmp.dedup.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.bam /dev/shm/G_INPUT-iSLK-R.BSJs.tmp.dedup.bam
rm -f /dev/shm/G_INPUT-iSLK-R.BSJs.tmp.dedup.bam*

Submitted job 43 with external jobid '11296974'.

[Wed Mar 24 19:35:49 2021]
rule create_spliced_reads_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.spliced_reads.bam
    jobid: 118
    wildcards: sample=G_INPUT-iSLK-R
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_splice_reads.py --inbam /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam --outbam /dev/shm/G_INPUT-iSLK-R.SR.bam --tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.spliced_reads.bam /dev/shm/G_INPUT-iSLK-R.SR.bam
rm -f /dev/shm/G_INPUT-iSLK-R.SR.bam*

Submitted job 118 with external jobid '11296975'.

[Wed Mar 24 19:35:50 2021]
rule annotate_circRNA:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Chimeric.out.junction
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer/G_INPUT-iSLK-R.back_spliced_junction.bed, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer/G_INPUT-iSLK-R.circularRNA_known.txt
    jobid: 59
    wildcards: sample=G_INPUT-iSLK-R


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer;fi
cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Chimeric.out.junction /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Chimeric.out.junction.original
grep -v junction_type /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Chimeric.out.junction.original > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Chimeric.out.junction
CIRCexplorer2 parse 	-t STAR 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Chimeric.out.junction > G_INPUT-iSLK-R_circexplorer_parse.log 2>&1
mv back_spliced_junction.bed /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer/G_INPUT-iSLK-R.back_spliced_junction.bed
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Chimeric.out.junction.original /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Chimeric.out.junction
CIRCexplorer2 annotate -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -g /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer/G_INPUT-iSLK-R.back_spliced_junction.bed -o $(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer/G_INPUT-iSLK-R.circularRNA_known.txt) --low-confidence

Submitted job 59 with external jobid '11296976'.

[Wed Mar 24 19:35:51 2021]
rule estimate_duplication:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-iSLK-R.MarkDuplicates.metrics.txt
    jobid: 35
    wildcards: sample=G_INPUT-iSLK-R


java -Xmx100G -jar ${PICARD_JARPATH}/picard.jar MarkDuplicates I=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam O=/dev/shm/G_INPUT-iSLK-R.mark_dup.bam M=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-iSLK-R.MarkDuplicates.metrics.txt

Submitted job 35 with external jobid '11296977'.
[Wed Mar 24 19:36:35 2021]
Finished job 31.
44 of 126 steps (35%) done

[Wed Mar 24 19:36:35 2021]
rule annotate_circRNA:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Chimeric.out.junction
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer/G_293t-NT.back_spliced_junction.bed, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer/G_293t-NT.circularRNA_known.txt
    jobid: 64
    wildcards: sample=G_293t-NT


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer;fi
cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Chimeric.out.junction /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Chimeric.out.junction.original
grep -v junction_type /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Chimeric.out.junction.original > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Chimeric.out.junction
CIRCexplorer2 parse 	-t STAR 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Chimeric.out.junction > G_293t-NT_circexplorer_parse.log 2>&1
mv back_spliced_junction.bed /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer/G_293t-NT.back_spliced_junction.bed
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Chimeric.out.junction.original /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Chimeric.out.junction
CIRCexplorer2 annotate -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -g /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer/G_293t-NT.back_spliced_junction.bed -o $(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer/G_293t-NT.circularRNA_known.txt) --low-confidence

Submitted job 64 with external jobid '11296978'.

[Wed Mar 24 19:36:37 2021]
rule create_spliced_reads_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.spliced_reads.bam
    jobid: 123
    wildcards: sample=G_293t-NT
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_splice_reads.py --inbam /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam --outbam /dev/shm/G_293t-NT.SR.bam --tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.spliced_reads.bam /dev/shm/G_293t-NT.SR.bam
rm -f /dev/shm/G_293t-NT.SR.bam*

Submitted job 123 with external jobid '11296979'.

[Wed Mar 24 19:36:38 2021]
rule estimate_duplication:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_293t-NT.MarkDuplicates.metrics.txt
    jobid: 40
    wildcards: sample=G_293t-NT


java -Xmx100G -jar ${PICARD_JARPATH}/picard.jar MarkDuplicates I=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam O=/dev/shm/G_293t-NT.mark_dup.bam M=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_293t-NT.MarkDuplicates.metrics.txt

Submitted job 40 with external jobid '11296980'.

[Wed Mar 24 19:36:39 2021]
rule create_BSJ_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.readids, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.bam
    jobid: 48
    wildcards: sample=G_293t-NT
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p

## get BSJ readids along with chrom,site,cigar etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/junctions2readids.py -j /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Chimeric.out.junction > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.readids

## extract only the uniq readids
cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.readids | sort | uniq > /dev/shm/G_293t-NT.readids

## downsize the star2p bam file to a new bam file with only BSJ reads ... these may still contain alignments which are chimeric but not BSJ
## note the argument --readids here is just a list of readids
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_by_readids.py --inputBAM /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam --outputBAM /dev/shm/G_293t-NT.chimeric.bam --readids /dev/shm/G_293t-NT.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_293t-NT.chimeric.sorted.bam /dev/shm/G_293t-NT.chimeric.bam
rm -f /dev/shm/G_293t-NT.chimeric.bam*

## using the downsized star2p bam file containing chimeric alignments ...included all the BSJs... we now extract only the BSJs
## note the argument --readids here is a tab delimited file created by junctions2readids.py ... reaids,chrom,strand,sites,cigars,etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_BSJs.py --inputBAM /dev/shm/G_293t-NT.chimeric.sorted.bam --outputBAM /dev/shm/G_293t-NT.BSJs.tmp.bam --readids /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_293t-NT.BSJs.tmp.sorted.bam /dev/shm/G_293t-NT.BSJs.tmp.bam
rm -f /dev/shm/G_293t-NT.BSJs.tmp.bam*

## some alignments are repeated/duplicated in the output for some reason ... hence deduplicating
samtools view -H /dev/shm/G_293t-NT.BSJs.tmp.sorted.bam > /dev/shm/G_293t-NT.BSJs.tmp.dedup.sam
samtools view /dev/shm/G_293t-NT.BSJs.tmp.sorted.bam | sort | uniq >> /dev/shm/G_293t-NT.BSJs.tmp.dedup.sam
samtools view -bS /dev/shm/G_293t-NT.BSJs.tmp.dedup.sam > /dev/shm/G_293t-NT.BSJs.tmp.dedup.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.bam /dev/shm/G_293t-NT.BSJs.tmp.dedup.bam
rm -f /dev/shm/G_293t-NT.BSJs.tmp.dedup.bam*

Submitted job 48 with external jobid '11296981'.
[Wed Mar 24 19:38:19 2021]
Finished job 28.
45 of 126 steps (36%) done

[Wed Mar 24 19:38:19 2021]
rule create_BSJ_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.readids, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.bam
    jobid: 45
    wildcards: sample=G_iSLK-R
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p

## get BSJ readids along with chrom,site,cigar etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/junctions2readids.py -j /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Chimeric.out.junction > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.readids

## extract only the uniq readids
cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.readids | sort | uniq > /dev/shm/G_iSLK-R.readids

## downsize the star2p bam file to a new bam file with only BSJ reads ... these may still contain alignments which are chimeric but not BSJ
## note the argument --readids here is just a list of readids
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_by_readids.py --inputBAM /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam --outputBAM /dev/shm/G_iSLK-R.chimeric.bam --readids /dev/shm/G_iSLK-R.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_iSLK-R.chimeric.sorted.bam /dev/shm/G_iSLK-R.chimeric.bam
rm -f /dev/shm/G_iSLK-R.chimeric.bam*

## using the downsized star2p bam file containing chimeric alignments ...included all the BSJs... we now extract only the BSJs
## note the argument --readids here is a tab delimited file created by junctions2readids.py ... reaids,chrom,strand,sites,cigars,etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_BSJs.py --inputBAM /dev/shm/G_iSLK-R.chimeric.sorted.bam --outputBAM /dev/shm/G_iSLK-R.BSJs.tmp.bam --readids /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_iSLK-R.BSJs.tmp.sorted.bam /dev/shm/G_iSLK-R.BSJs.tmp.bam
rm -f /dev/shm/G_iSLK-R.BSJs.tmp.bam*

## some alignments are repeated/duplicated in the output for some reason ... hence deduplicating
samtools view -H /dev/shm/G_iSLK-R.BSJs.tmp.sorted.bam > /dev/shm/G_iSLK-R.BSJs.tmp.dedup.sam
samtools view /dev/shm/G_iSLK-R.BSJs.tmp.sorted.bam | sort | uniq >> /dev/shm/G_iSLK-R.BSJs.tmp.dedup.sam
samtools view -bS /dev/shm/G_iSLK-R.BSJs.tmp.dedup.sam > /dev/shm/G_iSLK-R.BSJs.tmp.dedup.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.bam /dev/shm/G_iSLK-R.BSJs.tmp.dedup.bam
rm -f /dev/shm/G_iSLK-R.BSJs.tmp.dedup.bam*

Submitted job 45 with external jobid '11296991'.

[Wed Mar 24 19:38:20 2021]
rule annotate_circRNA:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Chimeric.out.junction
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer/G_iSLK-R.back_spliced_junction.bed, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer/G_iSLK-R.circularRNA_known.txt
    jobid: 61
    wildcards: sample=G_iSLK-R


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer;fi
cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Chimeric.out.junction /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Chimeric.out.junction.original
grep -v junction_type /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Chimeric.out.junction.original > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Chimeric.out.junction
CIRCexplorer2 parse 	-t STAR 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Chimeric.out.junction > G_iSLK-R_circexplorer_parse.log 2>&1
mv back_spliced_junction.bed /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer/G_iSLK-R.back_spliced_junction.bed
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Chimeric.out.junction.original /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Chimeric.out.junction
CIRCexplorer2 annotate -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -g /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer/G_iSLK-R.back_spliced_junction.bed -o $(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer/G_iSLK-R.circularRNA_known.txt) --low-confidence

Submitted job 61 with external jobid '11296992'.

[Wed Mar 24 19:38:21 2021]
rule create_spliced_reads_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.spliced_reads.bam
    jobid: 120
    wildcards: sample=G_iSLK-R
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_splice_reads.py --inbam /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam --outbam /dev/shm/G_iSLK-R.SR.bam --tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.spliced_reads.bam /dev/shm/G_iSLK-R.SR.bam
rm -f /dev/shm/G_iSLK-R.SR.bam*

Submitted job 120 with external jobid '11296993'.

[Wed Mar 24 19:38:23 2021]
rule estimate_duplication:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_iSLK-R.MarkDuplicates.metrics.txt
    jobid: 37
    wildcards: sample=G_iSLK-R


java -Xmx100G -jar ${PICARD_JARPATH}/picard.jar MarkDuplicates I=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam O=/dev/shm/G_iSLK-R.mark_dup.bam M=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_iSLK-R.MarkDuplicates.metrics.txt

Submitted job 37 with external jobid '11296994'.
[Wed Mar 24 19:38:32 2021]
Finished job 33.
46 of 126 steps (37%) done

[Wed Mar 24 19:38:32 2021]
localrule merge_genecounts:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.ReadsPerGene.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/unstranded_STAR_GeneCounts.tsv, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/stranded_STAR_GeneCounts.tsv, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/revstranded_STAR_GeneCounts.tsv
    jobid: 34


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results
Rscript /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/merge_ReadsPerGene_counts.R

Activating environment modules: R/4.0.3

[Wed Mar 24 19:38:32 2021]
rule create_spliced_reads_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.spliced_reads.bam
    jobid: 125
    wildcards: sample=G_INPUT-293T-NT
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_splice_reads.py --inbam /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam --outbam /dev/shm/G_INPUT-293T-NT.SR.bam --tab /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.spliced_reads.bam /dev/shm/G_INPUT-293T-NT.SR.bam
rm -f /dev/shm/G_INPUT-293T-NT.SR.bam*

[-] Unloading singularity  3.7.2  on cn4487 
[-] Unloading snakemake  5.24.1 
[-] Unloading python 3.7  ... 
Submitted job 125 with external jobid '11296995'.

[Wed Mar 24 19:38:33 2021]
rule estimate_duplication:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-293T-NT.MarkDuplicates.metrics.txt
    jobid: 42
    wildcards: sample=G_INPUT-293T-NT


java -Xmx100G -jar ${PICARD_JARPATH}/picard.jar MarkDuplicates I=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam O=/dev/shm/G_INPUT-293T-NT.mark_dup.bam M=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-293T-NT.MarkDuplicates.metrics.txt

Submitted job 42 with external jobid '11296996'.

[Wed Mar 24 19:38:34 2021]
rule create_BSJ_bam:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.readids, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.bam
    jobid: 50
    wildcards: sample=G_INPUT-293T-NT
    threads: 4


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p

## get BSJ readids along with chrom,site,cigar etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/junctions2readids.py -j /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Chimeric.out.junction > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.readids

## extract only the uniq readids
cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.readids | sort | uniq > /dev/shm/G_INPUT-293T-NT.readids

## downsize the star2p bam file to a new bam file with only BSJ reads ... these may still contain alignments which are chimeric but not BSJ
## note the argument --readids here is just a list of readids
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_by_readids.py --inputBAM /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam --outputBAM /dev/shm/G_INPUT-293T-NT.chimeric.bam --readids /dev/shm/G_INPUT-293T-NT.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_INPUT-293T-NT.chimeric.sorted.bam /dev/shm/G_INPUT-293T-NT.chimeric.bam
rm -f /dev/shm/G_INPUT-293T-NT.chimeric.bam*

## using the downsized star2p bam file containing chimeric alignments ...included all the BSJs... we now extract only the BSJs
## note the argument --readids here is a tab delimited file created by junctions2readids.py ... reaids,chrom,strand,sites,cigars,etc.
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/filter_bam_for_BSJs.py --inputBAM /dev/shm/G_INPUT-293T-NT.chimeric.sorted.bam --outputBAM /dev/shm/G_INPUT-293T-NT.BSJs.tmp.bam --readids /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.readids
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/dev/shm/G_INPUT-293T-NT.BSJs.tmp.sorted.bam /dev/shm/G_INPUT-293T-NT.BSJs.tmp.bam
rm -f /dev/shm/G_INPUT-293T-NT.BSJs.tmp.bam*

## some alignments are repeated/duplicated in the output for some reason ... hence deduplicating
samtools view -H /dev/shm/G_INPUT-293T-NT.BSJs.tmp.sorted.bam > /dev/shm/G_INPUT-293T-NT.BSJs.tmp.dedup.sam
samtools view /dev/shm/G_INPUT-293T-NT.BSJs.tmp.sorted.bam | sort | uniq >> /dev/shm/G_INPUT-293T-NT.BSJs.tmp.dedup.sam
samtools view -bS /dev/shm/G_INPUT-293T-NT.BSJs.tmp.dedup.sam > /dev/shm/G_INPUT-293T-NT.BSJs.tmp.dedup.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=4 --out=/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.bam /dev/shm/G_INPUT-293T-NT.BSJs.tmp.dedup.bam
rm -f /dev/shm/G_INPUT-293T-NT.BSJs.tmp.dedup.bam*

[+] Loading gcc  9.2.0  ... 
[+] Loading GSL 2.6 for GCC 9.2.0 ... 
[-] Unloading gcc  9.2.0  ... 
[+] Loading gcc  9.2.0  ... 
[+] Loading openmpi 3.1.4  for GCC 9.2.0 
[+] Loading ImageMagick  7.0.8  on cn4487 
[+] Loading HDF5  1.10.4 
[-] Unloading gcc  9.2.0  ... 
[+] Loading gcc  9.2.0  ... 
[+] Loading NetCDF 4.7.4_gcc9.2.0 
[+] Loading pandoc  2.13  on cn4487 
[+] Loading pcre2 10.21  ... 
[+] Loading R 4.0.3 
[INFO] Please allocate lscratch for batch/sinteractive R jobs
Submitted job 50 with external jobid '11296998'.

[Wed Mar 24 19:38:36 2021]
rule annotate_circRNA:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Chimeric.out.junction
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer/G_INPUT-293T-NT.back_spliced_junction.bed, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer/G_INPUT-293T-NT.circularRNA_known.txt
    jobid: 66
    wildcards: sample=G_INPUT-293T-NT


if [ ! -d /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer ];then mkdir /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer;fi
cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Chimeric.out.junction /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Chimeric.out.junction.original
grep -v junction_type /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Chimeric.out.junction.original > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Chimeric.out.junction
CIRCexplorer2 parse 	-t STAR 	/gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Chimeric.out.junction > G_INPUT-293T-NT_circexplorer_parse.log 2>&1
mv back_spliced_junction.bed /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer/G_INPUT-293T-NT.back_spliced_junction.bed
mv /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Chimeric.out.junction.original /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Chimeric.out.junction
CIRCexplorer2 annotate -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -g /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer/G_INPUT-293T-NT.back_spliced_junction.bed -o $(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer/G_INPUT-293T-NT.circularRNA_known.txt) --low-confidence

Submitted job 66 with external jobid '11296999'.
[Wed Mar 24 19:38:55 2021]
Finished job 34.
47 of 126 steps (37%) done
[Wed Mar 24 19:41:21 2021]
Finished job 46.
48 of 126 steps (38%) done

[Wed Mar 24 19:41:21 2021]
rule split_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.hg38.bw
    jobid: 80
    wildcards: sample=G_iSLK-UR
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 80 with external jobid '11297003'.
[Wed Mar 24 19:42:13 2021]
Finished job 49.
49 of 126 steps (39%) done

[Wed Mar 24 19:42:13 2021]
rule split_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.hg38.bw
    jobid: 83
    wildcards: sample=G_INPUT-293T-T
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 83 with external jobid '11297008'.
[Wed Mar 24 19:42:39 2021]
Finished job 121.
50 of 126 steps (40%) done

[Wed Mar 24 19:42:39 2021]
rule alignment_stats:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.spliced_reads.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/alignmentstats.txt
    jobid: 54
    wildcards: sample=G_iSLK-UR
    threads: 4


while read a b;do echo $a;done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/tmp1
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/tmp2
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.spliced_reads.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/tmp3
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/tmp4
echo -ne "#region	aligned_fragments	spliced_fragments	BSJ_fragments
" > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/alignmentstats.txt
paste /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/tmp4 >> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/alignmentstats.txt
rm -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/tmp4 

Submitted job 54 with external jobid '11297010'.

[Wed Mar 24 19:42:40 2021]
rule split_splice_reads_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.spliced_reads.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.spliced_reads.hg38.bw
    jobid: 88
    wildcards: sample=G_iSLK-UR
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.spliced_reads.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.spliced_reads.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 88 with external jobid '11297011'.
[Wed Mar 24 19:42:53 2021]
Finished job 44.
51 of 126 steps (40%) done

[Wed Mar 24 19:42:53 2021]
rule split_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.hg38.bw
    jobid: 78
    wildcards: sample=G_293T-T
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 78 with external jobid '11297012'.
[Wed Mar 24 19:43:45 2021]
Finished job 47.
52 of 126 steps (41%) done

[Wed Mar 24 19:43:45 2021]
rule split_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.hg38.bw
    jobid: 81
    wildcards: sample=G_INPUT-iSLK-UR
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 81 with external jobid '11297013'.
[Wed Mar 24 19:51:21 2021]
Finished job 113.
53 of 126 steps (42%) done
[Wed Mar 24 19:51:22 2021]
Finished job 110.
54 of 126 steps (43%) done
[Wed Mar 24 19:51:22 2021]
Finished job 115.
55 of 126 steps (44%) done
[Wed Mar 24 19:51:22 2021]
Finished job 112.
56 of 126 steps (44%) done
[Wed Mar 24 19:51:22 2021]
Finished job 59.
57 of 126 steps (45%) done

[Wed Mar 24 19:51:22 2021]
rule venn:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer/G_INPUT-iSLK-R.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri/G_INPUT-iSLK-R.ciri.out
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/G_INPUT-iSLK-R.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/G_INPUT-iSLK-R.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/G_INPUT-iSLK-R.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/G_INPUT-iSLK-R.common.lst
    jobid: 109
    wildcards: sample=G_INPUT-iSLK-R
    threads: 2


cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri/G_INPUT-iSLK-R.ciri.out|grep -v circRNA_ID > /dev/shm/G_INPUT-iSLK-R.ciri.lst
cut -f1-3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer/G_INPUT-iSLK-R.circularRNA_known.txt|awk -F"\t" '{print $1":"$2+1"|"$3}' > /dev/shm/G_INPUT-iSLK-R.circExplorer.lst
2set_venn.R 	-l /dev/shm/G_INPUT-iSLK-R.ciri.lst 	-r /dev/shm/G_INPUT-iSLK-R.circExplorer.lst  	-p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/G_INPUT-iSLK-R.venn_mqc.png 	-m /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/G_INPUT-iSLK-R.cirionly.lst 	-s /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/G_INPUT-iSLK-R.circexploreronly.lst 	-c1 "CIRI2" 	-c2 "CircExplorer2" 	-c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/G_INPUT-iSLK-R.common.lst 	-t G_INPUT-iSLK-R

[Wed Mar 24 19:51:23 2021]
Finished job 66.
58 of 126 steps (46%) done
Submitted job 109 with external jobid '11297295'.

[Wed Mar 24 19:51:25 2021]
rule clear:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer/G_INPUT-iSLK-R.circularRNA_known.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/CLEAR/quant.txt
    jobid: 93
    wildcards: sample=G_INPUT-iSLK-R
    threads: 4


circ_quant -c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer/G_INPUT-iSLK-R.circularRNA_known.txt -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam -t -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/CLEAR/quant.txt

Submitted job 93 with external jobid '11297338'.

[Wed Mar 24 19:51:29 2021]
rule venn:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer/G_INPUT-293T-NT.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri/G_INPUT-293T-NT.ciri.out
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/G_INPUT-293T-NT.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/G_INPUT-293T-NT.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/G_INPUT-293T-NT.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/G_INPUT-293T-NT.common.lst
    jobid: 116
    wildcards: sample=G_INPUT-293T-NT
    threads: 2


cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri/G_INPUT-293T-NT.ciri.out|grep -v circRNA_ID > /dev/shm/G_INPUT-293T-NT.ciri.lst
cut -f1-3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer/G_INPUT-293T-NT.circularRNA_known.txt|awk -F"\t" '{print $1":"$2+1"|"$3}' > /dev/shm/G_INPUT-293T-NT.circExplorer.lst
2set_venn.R 	-l /dev/shm/G_INPUT-293T-NT.ciri.lst 	-r /dev/shm/G_INPUT-293T-NT.circExplorer.lst  	-p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/G_INPUT-293T-NT.venn_mqc.png 	-m /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/G_INPUT-293T-NT.cirionly.lst 	-s /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/G_INPUT-293T-NT.circexploreronly.lst 	-c1 "CIRI2" 	-c2 "CircExplorer2" 	-c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/G_INPUT-293T-NT.common.lst 	-t G_INPUT-293T-NT

Submitted job 116 with external jobid '11297342'.

[Wed Mar 24 19:51:31 2021]
rule clear:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer/G_INPUT-293T-NT.circularRNA_known.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/CLEAR/quant.txt
    jobid: 107
    wildcards: sample=G_INPUT-293T-NT
    threads: 4


circ_quant -c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer/G_INPUT-293T-NT.circularRNA_known.txt -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam -t -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/CLEAR/quant.txt

Submitted job 107 with external jobid '11297344'.
[Wed Mar 24 19:51:33 2021]
Finished job 64.
59 of 126 steps (47%) done

[Wed Mar 24 19:51:33 2021]
rule venn:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer/G_293t-NT.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri/G_293t-NT.ciri.out
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/G_293t-NT.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/G_293t-NT.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/G_293t-NT.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/G_293t-NT.common.lst
    jobid: 114
    wildcards: sample=G_293t-NT
    threads: 2


cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri/G_293t-NT.ciri.out|grep -v circRNA_ID > /dev/shm/G_293t-NT.ciri.lst
cut -f1-3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer/G_293t-NT.circularRNA_known.txt|awk -F"\t" '{print $1":"$2+1"|"$3}' > /dev/shm/G_293t-NT.circExplorer.lst
2set_venn.R 	-l /dev/shm/G_293t-NT.ciri.lst 	-r /dev/shm/G_293t-NT.circExplorer.lst  	-p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/G_293t-NT.venn_mqc.png 	-m /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/G_293t-NT.cirionly.lst 	-s /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/G_293t-NT.circexploreronly.lst 	-c1 "CIRI2" 	-c2 "CircExplorer2" 	-c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/G_293t-NT.common.lst 	-t G_293t-NT

Submitted job 114 with external jobid '11297346'.

[Wed Mar 24 19:51:34 2021]
rule clear:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer/G_293t-NT.circularRNA_known.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/CLEAR/quant.txt
    jobid: 103
    wildcards: sample=G_293t-NT
    threads: 4


circ_quant -c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer/G_293t-NT.circularRNA_known.txt -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam -t -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/CLEAR/quant.txt

[Wed Mar 24 19:51:35 2021]
Finished job 61.
60 of 126 steps (48%) done
Submitted job 103 with external jobid '11297347'.

[Wed Mar 24 19:51:36 2021]
rule clear:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer/G_iSLK-R.circularRNA_known.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/CLEAR/quant.txt
    jobid: 97
    wildcards: sample=G_iSLK-R
    threads: 4


circ_quant -c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer/G_iSLK-R.circularRNA_known.txt -b /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam -t -r /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.genes.genepred_w_geneid -o /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/CLEAR/quant.txt

Submitted job 97 with external jobid '11297348'.

[Wed Mar 24 19:51:37 2021]
rule venn:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer/G_iSLK-R.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri/G_iSLK-R.ciri.out
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/G_iSLK-R.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/G_iSLK-R.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/G_iSLK-R.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/G_iSLK-R.common.lst
    jobid: 111
    wildcards: sample=G_iSLK-R
    threads: 2


cut -f1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri/G_iSLK-R.ciri.out|grep -v circRNA_ID > /dev/shm/G_iSLK-R.ciri.lst
cut -f1-3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer/G_iSLK-R.circularRNA_known.txt|awk -F"\t" '{print $1":"$2+1"|"$3}' > /dev/shm/G_iSLK-R.circExplorer.lst
2set_venn.R 	-l /dev/shm/G_iSLK-R.ciri.lst 	-r /dev/shm/G_iSLK-R.circExplorer.lst  	-p /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/G_iSLK-R.venn_mqc.png 	-m /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/G_iSLK-R.cirionly.lst 	-s /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/G_iSLK-R.circexploreronly.lst 	-c1 "CIRI2" 	-c2 "CircExplorer2" 	-c /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/G_iSLK-R.common.lst 	-t G_iSLK-R

Submitted job 111 with external jobid '11297349'.

[Wed Mar 24 19:51:38 2021]
rule create_circexplorer_count_matrix:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer/G_INPUT-iSLK-R.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer/G_293T-T.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer/G_iSLK-R.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer/G_iSLK-UR.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer/G_INPUT-iSLK-UR.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer/G_293t-NT.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer/G_INPUT-293T-T.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer/G_INPUT-293T-NT.circularRNA_known.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/circExplorer_count_matrix.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/circExplorer_BSJ_count_matrix.txt
    jobid: 76


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/Create_circExplorer_count_matrix.py /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/hg38_2_hg19_lookup.txt
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/Create_circExplorer_BSJ_count_matrix.py /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/hg38_2_hg19_lookup.txt

Submitted job 76 with external jobid '11297350'.
[Wed Mar 24 19:53:43 2021]
Finished job 114.
61 of 126 steps (48%) done
[Wed Mar 24 19:53:46 2021]
Finished job 109.
62 of 126 steps (49%) done
[Wed Mar 24 19:53:46 2021]
Finished job 116.
63 of 126 steps (50%) done
[Wed Mar 24 19:53:46 2021]
Finished job 111.
64 of 126 steps (51%) done
[Wed Mar 24 19:53:46 2021]
Finished job 76.
65 of 126 steps (52%) done
[Wed Mar 24 19:55:41 2021]
Finished job 122.
66 of 126 steps (52%) done

[Wed Mar 24 19:55:41 2021]
rule alignment_stats:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.spliced_reads.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/alignmentstats.txt
    jobid: 55
    wildcards: sample=G_INPUT-iSLK-UR
    threads: 4


while read a b;do echo $a;done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/tmp1
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/tmp2
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.spliced_reads.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/tmp3
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/tmp4
echo -ne "#region	aligned_fragments	spliced_fragments	BSJ_fragments
" > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/alignmentstats.txt
paste /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/tmp4 >> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/alignmentstats.txt
rm -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/tmp4 

[Wed Mar 24 19:55:42 2021]
Finished job 118.
67 of 126 steps (53%) done
Submitted job 55 with external jobid '11297568'.

[Wed Mar 24 19:55:43 2021]
rule split_splice_reads_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.spliced_reads.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.spliced_reads.hg38.bw
    jobid: 89
    wildcards: sample=G_INPUT-iSLK-UR
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.spliced_reads.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.spliced_reads.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 89 with external jobid '11297570'.

[Wed Mar 24 19:55:44 2021]
rule split_splice_reads_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.spliced_reads.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.spliced_reads.hg38.bw
    jobid: 85
    wildcards: sample=G_INPUT-iSLK-R
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.spliced_reads.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.spliced_reads.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 85 with external jobid '11297571'.
[Wed Mar 24 19:56:19 2021]
Finished job 80.
68 of 126 steps (54%) done
[Wed Mar 24 19:56:33 2021]
Finished job 124.
69 of 126 steps (55%) done

[Wed Mar 24 19:56:33 2021]
rule alignment_stats:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.spliced_reads.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/alignmentstats.txt
    jobid: 57
    wildcards: sample=G_INPUT-293T-T
    threads: 4


while read a b;do echo $a;done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/tmp1
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/tmp2
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.spliced_reads.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/tmp3
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/tmp4
echo -ne "#region	aligned_fragments	spliced_fragments	BSJ_fragments
" > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/alignmentstats.txt
paste /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/tmp4 >> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/alignmentstats.txt
rm -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/tmp4 

Submitted job 57 with external jobid '11297578'.

[Wed Mar 24 19:56:35 2021]
rule split_splice_reads_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.spliced_reads.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.spliced_reads.hg38.bw
    jobid: 91
    wildcards: sample=G_INPUT-293T-T
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.spliced_reads.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.spliced_reads.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 91 with external jobid '11297580'.
[Wed Mar 24 19:56:58 2021]
Finished job 81.
70 of 126 steps (56%) done
[Wed Mar 24 19:56:59 2021]
Finished job 99.
71 of 126 steps (56%) done

[Wed Mar 24 19:56:59 2021]
localrule annotate_clear_output:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/CLEAR/quant.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/CLEAR/quant.txt.annotated
    jobid: 100
    wildcards: sample=G_iSLK-UR


## cleanup quant.txt* dirs before annotation
find /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/CLEAR -maxdepth 1 -type d -name "quant.txt*" -exec rm -rf {} \;
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/annotate_clear_quant.py /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/hg38_2_hg19_lookup.txt /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/CLEAR/quant.txt

[Wed Mar 24 19:57:02 2021]
Finished job 100.
72 of 126 steps (57%) done
[Wed Mar 24 19:57:24 2021]
Finished job 78.
73 of 126 steps (58%) done
[Wed Mar 24 19:57:24 2021]
Finished job 83.
74 of 126 steps (59%) done
[Wed Mar 24 19:57:51 2021]
Finished job 105.
75 of 126 steps (60%) done

[Wed Mar 24 19:57:51 2021]
localrule annotate_clear_output:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/CLEAR/quant.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/CLEAR/quant.txt.annotated
    jobid: 106
    wildcards: sample=G_INPUT-293T-T


## cleanup quant.txt* dirs before annotation
find /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/CLEAR -maxdepth 1 -type d -name "quant.txt*" -exec rm -rf {} \;
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/annotate_clear_quant.py /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/hg38_2_hg19_lookup.txt /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/CLEAR/quant.txt

[Wed Mar 24 19:57:53 2021]
Finished job 106.
76 of 126 steps (60%) done
[Wed Mar 24 19:58:04 2021]
Finished job 101.
77 of 126 steps (61%) done

[Wed Mar 24 19:58:04 2021]
localrule annotate_clear_output:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/CLEAR/quant.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/CLEAR/quant.txt.annotated
    jobid: 102
    wildcards: sample=G_INPUT-iSLK-UR


## cleanup quant.txt* dirs before annotation
find /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/CLEAR -maxdepth 1 -type d -name "quant.txt*" -exec rm -rf {} \;
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/annotate_clear_quant.py /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/hg38_2_hg19_lookup.txt /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/CLEAR/quant.txt

[Wed Mar 24 19:58:06 2021]
Finished job 102.
78 of 126 steps (62%) done
[Wed Mar 24 19:58:15 2021]
Finished job 88.
79 of 126 steps (63%) done
[Wed Mar 24 20:00:05 2021]
Finished job 95.
80 of 126 steps (63%) done

[Wed Mar 24 20:00:05 2021]
localrule annotate_clear_output:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/CLEAR/quant.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/CLEAR/quant.txt.annotated
    jobid: 96
    wildcards: sample=G_293T-T


## cleanup quant.txt* dirs before annotation
find /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/CLEAR -maxdepth 1 -type d -name "quant.txt*" -exec rm -rf {} \;
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/annotate_clear_quant.py /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/hg38_2_hg19_lookup.txt /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/CLEAR/quant.txt

[Wed Mar 24 20:00:06 2021]
Finished job 50.
81 of 126 steps (64%) done

[Wed Mar 24 20:00:06 2021]
rule split_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.hg38.bw
    jobid: 84
    wildcards: sample=G_INPUT-293T-NT
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

[Wed Mar 24 20:00:07 2021]
Finished job 96.
82 of 126 steps (65%) done
Submitted job 84 with external jobid '11297999'.
[Wed Mar 24 20:00:16 2021]
Finished job 43.
83 of 126 steps (66%) done

[Wed Mar 24 20:00:16 2021]
rule split_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.hg38.bw
    jobid: 77
    wildcards: sample=G_INPUT-iSLK-R
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 77 with external jobid '11298001'.

[Wed Mar 24 20:00:17 2021]
rule alignment_stats:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.spliced_reads.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/alignmentstats.txt
    jobid: 51
    wildcards: sample=G_INPUT-iSLK-R
    threads: 4


while read a b;do echo $a;done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/tmp1
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/tmp2
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.spliced_reads.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/tmp3
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/tmp4
echo -ne "#region	aligned_fragments	spliced_fragments	BSJ_fragments
" > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/alignmentstats.txt
paste /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/tmp4 >> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/alignmentstats.txt
rm -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/tmp4 

Submitted job 51 with external jobid '11298002'.
[Wed Mar 24 20:01:16 2021]
Finished job 125.
84 of 126 steps (67%) done

[Wed Mar 24 20:01:16 2021]
rule alignment_stats:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.spliced_reads.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/alignmentstats.txt
    jobid: 58
    wildcards: sample=G_INPUT-293T-NT
    threads: 4


while read a b;do echo $a;done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/tmp1
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/tmp2
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.spliced_reads.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/tmp3
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/tmp4
echo -ne "#region	aligned_fragments	spliced_fragments	BSJ_fragments
" > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/alignmentstats.txt
paste /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/tmp4 >> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/alignmentstats.txt
rm -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/tmp4 

Submitted job 58 with external jobid '11298020'.

[Wed Mar 24 20:01:17 2021]
rule split_splice_reads_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.spliced_reads.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.spliced_reads.hg38.bw
    jobid: 92
    wildcards: sample=G_INPUT-293T-NT
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.spliced_reads.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.spliced_reads.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

[Wed Mar 24 20:01:18 2021]
Finished job 107.
85 of 126 steps (67%) done
Submitted job 92 with external jobid '11298021'.

[Wed Mar 24 20:01:19 2021]
localrule annotate_clear_output:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/CLEAR/quant.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/CLEAR/quant.txt.annotated
    jobid: 108
    wildcards: sample=G_INPUT-293T-NT


## cleanup quant.txt* dirs before annotation
find /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/CLEAR -maxdepth 1 -type d -name "quant.txt*" -exec rm -rf {} \;
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/annotate_clear_quant.py /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/hg38_2_hg19_lookup.txt /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/CLEAR/quant.txt

[Wed Mar 24 20:01:21 2021]
Finished job 108.
86 of 126 steps (68%) done
[Wed Mar 24 20:02:05 2021]
Finished job 48.
87 of 126 steps (69%) done

[Wed Mar 24 20:02:05 2021]
rule split_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.hg38.bw
    jobid: 82
    wildcards: sample=G_293t-NT
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 82 with external jobid '11298034'.
[Wed Mar 24 20:02:17 2021]
Finished job 119.
88 of 126 steps (70%) done

[Wed Mar 24 20:02:17 2021]
rule split_splice_reads_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.spliced_reads.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.spliced_reads.hg38.bw
    jobid: 86
    wildcards: sample=G_293T-T
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.spliced_reads.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.spliced_reads.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 86 with external jobid '11298035'.

[Wed Mar 24 20:02:18 2021]
rule alignment_stats:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.spliced_reads.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/alignmentstats.txt
    jobid: 52
    wildcards: sample=G_293T-T
    threads: 4


while read a b;do echo $a;done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/tmp1
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/tmp2
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.spliced_reads.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/tmp3
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/tmp4
echo -ne "#region	aligned_fragments	spliced_fragments	BSJ_fragments
" > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/alignmentstats.txt
paste /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/tmp4 >> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/alignmentstats.txt
rm -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/tmp4 

Submitted job 52 with external jobid '11298036'.
[Wed Mar 24 20:02:52 2021]
Finished job 103.
89 of 126 steps (71%) done

[Wed Mar 24 20:02:52 2021]
localrule annotate_clear_output:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/CLEAR/quant.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/CLEAR/quant.txt.annotated
    jobid: 104
    wildcards: sample=G_293t-NT


## cleanup quant.txt* dirs before annotation
find /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/CLEAR -maxdepth 1 -type d -name "quant.txt*" -exec rm -rf {} \;
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/annotate_clear_quant.py /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/hg38_2_hg19_lookup.txt /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/CLEAR/quant.txt

[Wed Mar 24 20:02:54 2021]
Finished job 104.
90 of 126 steps (71%) done
[Wed Mar 24 20:02:54 2021]
Finished job 91.
91 of 126 steps (72%) done
[Wed Mar 24 20:03:05 2021]
Finished job 85.
92 of 126 steps (73%) done
[Wed Mar 24 20:03:17 2021]
Finished job 89.
93 of 126 steps (74%) done
[Wed Mar 24 20:03:53 2021]
Finished job 97.
94 of 126 steps (75%) done

[Wed Mar 24 20:03:53 2021]
localrule annotate_clear_output:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/CLEAR/quant.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/CLEAR/quant.txt.annotated
    jobid: 98
    wildcards: sample=G_iSLK-R


## cleanup quant.txt* dirs before annotation
find /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/CLEAR -maxdepth 1 -type d -name "quant.txt*" -exec rm -rf {} \;
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/annotate_clear_quant.py /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/hg38_2_hg19_lookup.txt /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/CLEAR/quant.txt

[Wed Mar 24 20:03:55 2021]
Finished job 98.
95 of 126 steps (75%) done
[Wed Mar 24 20:04:16 2021]
Finished job 38.
96 of 126 steps (76%) done
[Wed Mar 24 20:04:29 2021]
Finished job 93.
97 of 126 steps (77%) done

[Wed Mar 24 20:04:29 2021]
localrule annotate_clear_output:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/CLEAR/quant.txt
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/CLEAR/quant.txt.annotated
    jobid: 94
    wildcards: sample=G_INPUT-iSLK-R


## cleanup quant.txt* dirs before annotation
find /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/CLEAR -maxdepth 1 -type d -name "quant.txt*" -exec rm -rf {} \;
python /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/annotate_clear_quant.py /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/resources/hg38_2_hg19_lookup.txt /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/CLEAR/quant.txt

[Wed Mar 24 20:04:30 2021]
Finished job 94.
98 of 126 steps (78%) done
[Wed Mar 24 20:06:16 2021]
Finished job 45.
99 of 126 steps (79%) done

[Wed Mar 24 20:06:16 2021]
rule split_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.hg38.bw
    jobid: 79
    wildcards: sample=G_iSLK-R
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 79 with external jobid '11298116'.
[Wed Mar 24 20:07:04 2021]
Finished job 77.
100 of 126 steps (79%) done
[Wed Mar 24 20:07:05 2021]
Finished job 84.
101 of 126 steps (80%) done
[Wed Mar 24 20:07:16 2021]
Finished job 41.
102 of 126 steps (81%) done
[Wed Mar 24 20:07:38 2021]
Finished job 36.
103 of 126 steps (82%) done
[Wed Mar 24 20:07:39 2021]
Finished job 92.
104 of 126 steps (83%) done
[Wed Mar 24 20:08:22 2021]
Finished job 39.
105 of 126 steps (83%) done
[Wed Mar 24 20:09:07 2021]
Finished job 82.
106 of 126 steps (84%) done
[Wed Mar 24 20:09:18 2021]
Finished job 86.
107 of 126 steps (85%) done
[Wed Mar 24 20:12:25 2021]
Finished job 35.
108 of 126 steps (86%) done
[Wed Mar 24 20:12:36 2021]
Finished job 120.
109 of 126 steps (87%) done

[Wed Mar 24 20:12:36 2021]
rule alignment_stats:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.spliced_reads.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/alignmentstats.txt
    jobid: 53
    wildcards: sample=G_iSLK-R
    threads: 4


while read a b;do echo $a;done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/tmp1
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/tmp2
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.spliced_reads.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/tmp3
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/tmp4
echo -ne "#region	aligned_fragments	spliced_fragments	BSJ_fragments
" > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/alignmentstats.txt
paste /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/tmp4 >> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/alignmentstats.txt
rm -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/tmp4 

Submitted job 53 with external jobid '11298165'.

[Wed Mar 24 20:12:37 2021]
rule split_splice_reads_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.spliced_reads.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.spliced_reads.hg38.bw
    jobid: 87
    wildcards: sample=G_iSLK-R
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.spliced_reads.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.spliced_reads.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 87 with external jobid '11298166'.
[Wed Mar 24 20:12:58 2021]
Finished job 79.
110 of 126 steps (87%) done
[Wed Mar 24 20:14:59 2021]
Finished job 40.
111 of 126 steps (88%) done
[Wed Mar 24 20:15:54 2021]
Finished job 42.
112 of 126 steps (89%) done
[Wed Mar 24 20:19:34 2021]
Finished job 37.
113 of 126 steps (90%) done

[Wed Mar 24 20:19:34 2021]
localrule multiqc:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-iSLK-R.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_293T-T.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_iSLK-R.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_iSLK-UR.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-iSLK-UR.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_293t-NT.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-293T-T.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-293T-NT.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_INPUT-iSLK-R.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_293T-T.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_iSLK-R.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_iSLK-UR.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_INPUT-iSLK-UR.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_293t-NT.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_INPUT-293T-T.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_INPUT-293T-NT.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/multiqc_report.html
    jobid: 117


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16
multiqc .

Activating environment modules: multiqc/1.9
[-] Unloading singularity  3.7.2  on cn4487 
[-] Unloading snakemake  5.24.1 
[-] Unloading python 3.7  ... 
[+] Loading singularity  3.7.2  on cn4487 
[+] Loading multiqc  1.9 
[WARNING]         multiqc : MultiQC Version v1.10 now available!
[INFO   ]         multiqc : This is MultiQC v1.9
[INFO   ]         multiqc : Template    : default
[INFO   ]         multiqc : Searching   : /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16
[Wed Mar 24 20:20:25 2021]
Finished job 123.
114 of 126 steps (90%) done

[Wed Mar 24 20:20:25 2021]
rule alignment_stats:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.spliced_reads.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/alignmentstats.txt
    jobid: 56
    wildcards: sample=G_293t-NT
    threads: 4


while read a b;do echo $a;done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/tmp1
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/tmp2
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.spliced_reads.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/tmp3
while read a b;do bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/scripts/circRNA/workflow/scripts/bam_get_uniquely_aligned_fragments.bash /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.bam "$b";done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/tmp4
echo -ne "#region	aligned_fragments	spliced_fragments	BSJ_fragments
" > /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/alignmentstats.txt
paste /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/tmp4 >> /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/alignmentstats.txt
rm -f /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/tmp1 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/tmp2 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/tmp3 /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/tmp4 

Submitted job 56 with external jobid '11298338'.

[Wed Mar 24 20:20:27 2021]
rule split_splice_reads_BAM_create_BW:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.spliced_reads.bam
    output: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.spliced_reads.hg38.bw
    jobid: 90
    wildcards: sample=G_293t-NT
    threads: 2


cd /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p
bam_basename="$(basename /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.spliced_reads.bam)"
while read a b;do
bam="${bam_basename%.*}.${a}.bam"
samtools view /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.spliced_reads.bam $b -b > /dev/shm/${bam%.*}.tmp.bam
sambamba sort --memory-limit=100G --tmpdir=/dev/shm --nthreads=2 --out=$bam /dev/shm/${bam%.*}.tmp.bam
bw="${bam%.*}.bw"
bdg="${bam%.*}.bdg"
sizes="${bam%.*}.sizes"
bedtools genomecov -bga -split -ibam $bam > $bdg
bedSort $bdg $bdg
if [ "$(wc -l $bdg|awk '{print $1}')" != "0" ];then
samtools view -H $bam|grep ^@SQ|cut -f2,3|sed "s/SN://g"|sed "s/LN://g" > $sizes
bedGraphToBigWig $bdg $sizes $bw
else
touch $bw
fi
rm -f $bdg $sizes
done < /data/Ziegelbauer_lab/resources/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.v3/hg38_rRNA_masked_plus_rRNA_plus_viruses_plus_ERCC.fa.regions

Submitted job 90 with external jobid '11298339'.
[Wed Mar 24 20:20:35 2021]
Finished job 87.
115 of 126 steps (91%) done
[INFO   ]  custom_content : G_iSLK-UR.venn: Found 1 sample (image)
[INFO   ]  custom_content : G_INPUT-iSLK-R.venn: Found 1 sample (image)
[INFO   ]  custom_content : G_INPUT-293T-T.venn: Found 1 sample (image)
[INFO   ]  custom_content : G_INPUT-iSLK-UR.venn: Found 1 sample (image)
[INFO   ]  custom_content : G_293t-NT.venn: Found 1 sample (image)
[INFO   ]  custom_content : G_293T-T.venn: Found 1 sample (image)
[INFO   ]  custom_content : G_INPUT-293T-NT.venn: Found 1 sample (image)
[INFO   ]  custom_content : G_iSLK-R.venn: Found 1 sample (image)
[INFO   ]          picard : Found 8 MarkDuplicates reports
[INFO   ]            star : Found 16 reports and 8 gene count files
[INFO   ]        cutadapt : Found 8 reports
[INFO   ]          fastqc : Found 16 reports
[INFO   ]         multiqc : Compressing plot data
[INFO   ]         multiqc : Report      : multiqc_report.html
[INFO   ]         multiqc : Data        : multiqc_data
[INFO   ]         multiqc : MultiQC complete
[Wed Mar 24 20:20:58 2021]
Finished job 117.
116 of 126 steps (92%) done
[Wed Mar 24 20:21:46 2021]
Finished job 54.
117 of 126 steps (93%) done
[Wed Mar 24 20:25:07 2021]
Finished job 57.
118 of 126 steps (94%) done
[Wed Mar 24 20:29:07 2021]
Finished job 90.
119 of 126 steps (94%) done
[Wed Mar 24 20:31:27 2021]
Finished job 52.
120 of 126 steps (95%) done
[Wed Mar 24 20:33:37 2021]
Finished job 55.
121 of 126 steps (96%) done
[Wed Mar 24 20:38:38 2021]
Finished job 58.
122 of 126 steps (97%) done
[Wed Mar 24 20:39:38 2021]
Finished job 51.
123 of 126 steps (98%) done
[Wed Mar 24 20:58:49 2021]
Finished job 53.
124 of 126 steps (98%) done
[Wed Mar 24 21:05:19 2021]
Finished job 56.
125 of 126 steps (99%) done

[Wed Mar 24 21:05:19 2021]
localrule all:
    input: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R1.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/trim/G_INPUT-iSLK-R.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/trim/G_293T-T.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/trim/G_iSLK-R.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/trim/G_iSLK-UR.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/trim/G_INPUT-iSLK-UR.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/trim/G_293t-NT.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/trim/G_INPUT-293T-T.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/trim/G_INPUT-293T-NT.R2.trim.fastq.gz, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_INPUT-iSLK-R.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_293T-T.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_iSLK-R.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_iSLK-UR.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_INPUT-iSLK-UR.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_293t-NT.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_INPUT-293T-T.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/fastqc/G_INPUT-293T-NT.R1.trim_fastqc.zip, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR1p/G_INPUT-iSLK-R_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR1p/G_293T-T_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR1p/G_iSLK-R_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR1p/G_iSLK-UR_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR1p/G_INPUT-iSLK-UR_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR1p/G_293t-NT_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR1p/G_INPUT-293T-T_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR1p/G_INPUT-293T-NT_p1.SJ.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/pass1.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Chimeric.out.junction, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.Aligned.sortedByCoord.out.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT_p2.ReadsPerGene.out.tab, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/stranded_STAR_GeneCounts.tsv, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-iSLK-R.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_293T-T.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_iSLK-R.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_iSLK-UR.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-iSLK-UR.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_293t-NT.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-293T-T.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/qc/picard_MarkDuplicates/G_INPUT-293T-NT.MarkDuplicates.metrics.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/alignmentstats.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/alignmentstats.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/alignmentstats.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/alignmentstats.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/alignmentstats.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/alignmentstats.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/alignmentstats.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/alignmentstats.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/circExplorer/G_INPUT-iSLK-R.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/circExplorer/G_293T-T.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/circExplorer/G_iSLK-R.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/circExplorer/G_iSLK-UR.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/circExplorer/G_INPUT-iSLK-UR.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/circExplorer/G_293t-NT.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/circExplorer/G_INPUT-293T-T.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/circExplorer/G_INPUT-293T-NT.circularRNA_known.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/ciri/G_INPUT-iSLK-R.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/ciri/G_293T-T.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/ciri/G_iSLK-R.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/ciri/G_iSLK-UR.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/ciri/G_INPUT-iSLK-UR.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/ciri/G_293t-NT.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/ciri/G_INPUT-293T-T.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/ciri/G_INPUT-293T-NT.ciri.out, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/ciri_count_matrix.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/circExplorer_count_matrix.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/circExplorer_BSJ_count_matrix.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.BSJ.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.BSJ.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.BSJ.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.BSJ.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.BSJ.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.BSJ.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.BSJ.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.BSJ.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.spliced_reads.hg38.bam, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/STAR2p/G_INPUT-iSLK-R.spliced_reads.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/STAR2p/G_293T-T.spliced_reads.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/STAR2p/G_iSLK-R.spliced_reads.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/STAR2p/G_iSLK-UR.spliced_reads.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/STAR2p/G_INPUT-iSLK-UR.spliced_reads.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/STAR2p/G_293t-NT.spliced_reads.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/STAR2p/G_INPUT-293T-T.spliced_reads.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/STAR2p/G_INPUT-293T-NT.spliced_reads.hg38.bw, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/CLEAR/quant.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/CLEAR/quant.txt.annotated, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/CLEAR/quant.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/CLEAR/quant.txt.annotated, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/CLEAR/quant.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/CLEAR/quant.txt.annotated, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/CLEAR/quant.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/CLEAR/quant.txt.annotated, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/CLEAR/quant.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/CLEAR/quant.txt.annotated, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/CLEAR/quant.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/CLEAR/quant.txt.annotated, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/CLEAR/quant.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/CLEAR/quant.txt.annotated, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/CLEAR/quant.txt, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/CLEAR/quant.txt.annotated, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/G_INPUT-iSLK-R.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/G_293T-T.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/G_iSLK-R.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/G_iSLK-UR.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/G_INPUT-iSLK-UR.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/G_293t-NT.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/G_INPUT-293T-T.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/G_INPUT-293T-NT.venn_mqc.png, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/G_INPUT-iSLK-R.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/G_293T-T.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/G_iSLK-R.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/G_iSLK-UR.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/G_INPUT-iSLK-UR.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/G_293t-NT.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/G_INPUT-293T-T.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/G_INPUT-293T-NT.cirionly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/G_INPUT-iSLK-R.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/G_293T-T.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/G_iSLK-R.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/G_iSLK-UR.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/G_INPUT-iSLK-UR.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/G_293t-NT.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/G_INPUT-293T-T.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/G_INPUT-293T-NT.circexploreronly.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-R/G_INPUT-iSLK-R.common.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293T-T/G_293T-T.common.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-R/G_iSLK-R.common.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_iSLK-UR/G_iSLK-UR.common.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-iSLK-UR/G_INPUT-iSLK-UR.common.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_293t-NT/G_293t-NT.common.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-T/G_INPUT-293T-T.common.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/results/G_INPUT-293T-NT/G_INPUT-293T-NT.common.lst, /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/multiqc_report.html
    jobid: 0

[Wed Mar 24 21:05:19 2021]
Finished job 0.
126 of 126 steps (100%) done
Complete log: /gpfs/gsfs12/users/Ziegelbauer_lab/circRNADetection/circRNA_daq_v0.4.2/samples_16/.snakemake/log/2021-03-24T174440.557790.snakemake.log
